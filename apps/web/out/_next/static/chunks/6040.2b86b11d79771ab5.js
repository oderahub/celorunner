"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6040],{76040:function(e,t,s){s.r(t),s.d(t,{default:function(){return R}});var i=s(78350),a=s(826),r=s.n(a),o=s(99151),n=s(87913),l=s(16139),h=s(4177),c=s(90059),d=s(75264),p=s(46949),m=s(79475),g=s(71178);function u(e){let{isOpen:t,onConfirm:s,onCancel:a,isMiniPay:o}=e;return t?(0,i.jsxs)("div",{className:"jsx-c98f7064ee831053 fixed inset-0 z-[100] flex items-center justify-center bg-black/90",children:[(0,i.jsx)(r(),{id:"c98f7064ee831053",children:'@import url("https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap");.pixel-border.jsx-c98f7064ee831053{-ms-interpolation-mode:nearest-neighbor;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:crisp-edges}.retro-button.jsx-c98f7064ee831053{font-family:"Press Start 2P",monospace;text-shadow:3px 3px 0px#000;-ms-interpolation-mode:nearest-neighbor;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;-webkit-transition:-webkit-transform.1s ease;-moz-transition:-moz-transform.1s ease;-o-transition:-o-transform.1s ease;transition:-webkit-transform.1s ease;transition:-moz-transform.1s ease;transition:-o-transform.1s ease;transition:transform.1s ease}.retro-button.jsx-c98f7064ee831053:hover{-webkit-transform:scale(1.05);-moz-transform:scale(1.05);-ms-transform:scale(1.05);-o-transform:scale(1.05);transform:scale(1.05)}.retro-button.jsx-c98f7064ee831053:active{-webkit-transform:scale(.98);-moz-transform:scale(.98);-ms-transform:scale(.98);-o-transform:scale(.98);transform:scale(.98)}.neon-glow.jsx-c98f7064ee831053{text-shadow:0 0 10px currentColor,0 0 20px currentColor,0 0 30px currentColor,3px 3px 0px#000}.scanline.jsx-c98f7064ee831053{background:-webkit-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:-moz-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:-o-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:repeating-linear-gradient(0deg,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);pointer-events:none}'}),(0,i.jsxs)("div",{style:{boxShadow:"0 0 20px rgba(0, 255, 65, 0.5), inset 0 0 60px rgba(0, 0, 0, 0.8)",fontFamily:"'Press Start 2P', monospace"},className:"jsx-c98f7064ee831053 relative bg-[#0A0E27] border-4 border-[#00FF41] p-8 max-w-md mx-4 pixel-border",children:[(0,i.jsx)("div",{className:"jsx-c98f7064ee831053 absolute inset-0 scanline pointer-events-none"}),(0,i.jsxs)("div",{className:"jsx-c98f7064ee831053 relative text-center",children:[(0,i.jsx)("div",{className:"jsx-c98f7064ee831053 mb-6",children:(0,i.jsx)("div",{style:{boxShadow:"4px 4px 0px #000000"},className:"jsx-c98f7064ee831053 mx-auto w-20 h-20 bg-[#FFD700] border-4 border-black flex items-center justify-center pixel-border",children:(0,i.jsx)("span",{className:"jsx-c98f7064ee831053 text-4xl",children:"\uD83D\uDCB0"})})}),(0,i.jsx)("h2",{style:{fontFamily:"'Press Start 2P', monospace"},className:"jsx-c98f7064ee831053 text-2xl text-[#00FF41] mb-6 neon-glow leading-relaxed",children:o?"INSERT COIN":"STAKE TO PLAY"}),(0,i.jsx)("p",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"2px 2px 0px #000000"},className:"jsx-c98f7064ee831053 text-white mb-6 text-xs leading-relaxed",children:o?"1 cUSD TO ENTER DAILY TOURNAMENT":"1 cUSD ENTRY FEE - TOP 10 WIN PRIZES!"}),(0,i.jsxs)("div",{style:{boxShadow:"inset 0 0 20px rgba(255, 215, 0, 0.2)"},className:"jsx-c98f7064ee831053 bg-black/70 border-2 border-[#FFD700] p-4 mb-6 text-left pixel-border",children:[(0,i.jsx)("p",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"2px 2px 0px #000000"},className:"jsx-c98f7064ee831053 text-[#FFD700] font-semibold mb-3 text-xs",children:"PRIZE POOL:"}),(0,i.jsxs)("div",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"1px 1px 0px #000000"},className:"jsx-c98f7064ee831053 text-[#20B2AA] text-[10px] space-y-2 leading-relaxed",children:[(0,i.jsx)("p",{className:"jsx-c98f7064ee831053",children:"1ST: 30%  2ND: 20%"}),(0,i.jsx)("p",{className:"jsx-c98f7064ee831053",children:"3RD: 15%  4TH: 10%"}),(0,i.jsx)("p",{className:"jsx-c98f7064ee831053",children:"5TH: 8%   6TH: 6%"}),(0,i.jsx)("p",{className:"jsx-c98f7064ee831053",children:"7-10: 1.5% EACH"})]})]}),(0,i.jsxs)("div",{className:"jsx-c98f7064ee831053 flex flex-col gap-4",children:[(0,i.jsx)("button",{onClick:s,style:{boxShadow:"6px 6px 0px #000000"},className:"jsx-c98f7064ee831053 retro-button w-full px-6 py-4 bg-[#00FF41] hover:bg-[#39FF14] text-black border-4 border-black text-sm",children:"INSERT COIN"}),(0,i.jsx)("button",{onClick:a,style:{boxShadow:"4px 4px 0px #000000"},className:"jsx-c98f7064ee831053 retro-button w-full px-6 py-3 bg-[#DC143C] hover:bg-[#FF0000] text-white border-4 border-black text-xs",children:"CANCEL"})]}),(0,i.jsx)("div",{className:"jsx-c98f7064ee831053 absolute top-2 left-2 w-4 h-4 border-t-2 border-l-2 border-[#00FF41]"}),(0,i.jsx)("div",{className:"jsx-c98f7064ee831053 absolute top-2 right-2 w-4 h-4 border-t-2 border-r-2 border-[#00FF41]"}),(0,i.jsx)("div",{className:"jsx-c98f7064ee831053 absolute bottom-2 left-2 w-4 h-4 border-b-2 border-l-2 border-[#00FF41]"}),(0,i.jsx)("div",{className:"jsx-c98f7064ee831053 absolute bottom-2 right-2 w-4 h-4 border-b-2 border-r-2 border-[#00FF41]"})]})]})]}):null}function f(e){let{isOpen:t,score:s,onConfirm:a,onCancel:o,isSubmitting:n=!1}=e;return t?(0,i.jsxs)("div",{className:"jsx-4af1028d542c7dd3 fixed inset-0 z-[100] flex items-center justify-center bg-black/90",children:[(0,i.jsx)(r(),{id:"4af1028d542c7dd3",children:'@import url("https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap");.pixel-border.jsx-4af1028d542c7dd3{-ms-interpolation-mode:nearest-neighbor;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:crisp-edges}.retro-button.jsx-4af1028d542c7dd3{font-family:"Press Start 2P",monospace;text-shadow:3px 3px 0px#000;-ms-interpolation-mode:nearest-neighbor;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;-webkit-transition:-webkit-transform.1s ease;-moz-transition:-moz-transform.1s ease;-o-transition:-o-transform.1s ease;transition:-webkit-transform.1s ease;transition:-moz-transform.1s ease;transition:-o-transform.1s ease;transition:transform.1s ease}.retro-button.jsx-4af1028d542c7dd3:hover:not(:disabled){-webkit-transform:scale(1.05);-moz-transform:scale(1.05);-ms-transform:scale(1.05);-o-transform:scale(1.05);transform:scale(1.05)}.retro-button.jsx-4af1028d542c7dd3:active:not(:disabled){-webkit-transform:scale(.98);-moz-transform:scale(.98);-ms-transform:scale(.98);-o-transform:scale(.98);transform:scale(.98)}.retro-button.jsx-4af1028d542c7dd3:disabled{opacity:.6;cursor:not-allowed}.neon-glow-gold.jsx-4af1028d542c7dd3{text-shadow:0 0 10px#FFD700,0 0 20px#FFD700,0 0 30px#FFD700,3px 3px 0px#000}.scanline.jsx-4af1028d542c7dd3{background:-webkit-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:-moz-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:-o-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:repeating-linear-gradient(0deg,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);pointer-events:none}@-webkit-keyframes blink{0%,49%{opacity:1}50%,100%{opacity:.3}}@-moz-keyframes blink{0%,49%{opacity:1}50%,100%{opacity:.3}}@-o-keyframes blink{0%,49%{opacity:1}50%,100%{opacity:.3}}@keyframes blink{0%,49%{opacity:1}50%,100%{opacity:.3}}.blink.jsx-4af1028d542c7dd3{-webkit-animation:blink 1s infinite;-moz-animation:blink 1s infinite;-o-animation:blink 1s infinite;animation:blink 1s infinite}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.spin.jsx-4af1028d542c7dd3{-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;animation:spin 1s linear infinite}'}),(0,i.jsxs)("div",{style:{boxShadow:"0 0 30px rgba(255, 215, 0, 0.6), inset 0 0 60px rgba(0, 0, 0, 0.8)",fontFamily:"'Press Start 2P', monospace"},className:"jsx-4af1028d542c7dd3 relative bg-[#0A0E27] border-4 border-[#FFD700] p-8 max-w-md mx-4 pixel-border",children:[(0,i.jsx)("div",{className:"jsx-4af1028d542c7dd3 absolute inset-0 scanline pointer-events-none"}),(0,i.jsxs)("div",{className:"jsx-4af1028d542c7dd3 relative text-center",children:[(0,i.jsx)("div",{className:"jsx-4af1028d542c7dd3 mb-6",children:(0,i.jsx)("div",{style:{boxShadow:"4px 4px 0px #000000"},className:"jsx-4af1028d542c7dd3 mx-auto w-20 h-20 bg-[#FFD700] border-4 border-black flex items-center justify-center pixel-border",children:(0,i.jsx)("span",{className:"jsx-4af1028d542c7dd3 text-4xl",children:"\uD83C\uDFC6"})})}),(0,i.jsx)("h2",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"0 0 20px #FF0000, 3px 3px 0px #000000"},className:"jsx-4af1028d542c7dd3 text-2xl text-[#FF0000] mb-6 leading-relaxed",children:"GAME OVER!"}),(0,i.jsxs)("div",{style:{boxShadow:"0 0 20px rgba(0, 255, 65, 0.4), inset 0 0 30px rgba(0, 0, 0, 0.9)"},className:"jsx-4af1028d542c7dd3 bg-black/70 border-4 border-[#00FF41] p-6 mb-6 pixel-border",children:[(0,i.jsx)("p",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"2px 2px 0px #000000"},className:"jsx-4af1028d542c7dd3 text-[#20B2AA] text-xs mb-3",children:"YOUR SCORE"}),(0,i.jsx)("p",{style:{fontFamily:"'Press Start 2P', monospace"},className:"jsx-4af1028d542c7dd3 text-5xl text-[#FFD700] neon-glow-gold leading-tight",children:s.toLocaleString()})]}),(0,i.jsx)("p",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"2px 2px 0px #000000"},className:"jsx-4af1028d542c7dd3 text-white mb-6 text-[10px] leading-relaxed",children:"SUBMIT TO BLOCKCHAIN LEADERBOARD!"}),(0,i.jsxs)("div",{style:{boxShadow:"inset 0 0 20px rgba(255, 215, 0, 0.1)"},className:"jsx-4af1028d542c7dd3 bg-[#FFD700]/10 border-2 border-[#FFD700] p-4 mb-6 text-left pixel-border",children:[(0,i.jsx)("p",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"2px 2px 0px #000000"},className:"jsx-4af1028d542c7dd3 text-[#FFD700] font-semibold mb-2 text-xs",children:"TOP 10 REWARDS:"}),(0,i.jsxs)("div",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"1px 1px 0px #000000"},className:"jsx-4af1028d542c7dd3 text-[#20B2AA] text-[9px] space-y-1 leading-relaxed",children:[(0,i.jsx)("p",{className:"jsx-4af1028d542c7dd3",children:"DAILY PRIZES @ MIDNIGHT"}),(0,i.jsx)("p",{className:"jsx-4af1028d542c7dd3 text-[#00FF41]",children:"BEST SCORE WINS!"})]})]}),(0,i.jsxs)("div",{className:"jsx-4af1028d542c7dd3 flex flex-col gap-4",children:[(0,i.jsx)("button",{onClick:a,disabled:n,style:{boxShadow:"6px 6px 0px #000000"},className:"jsx-4af1028d542c7dd3 retro-button w-full px-6 py-4 bg-[#00FF41] hover:bg-[#39FF14] disabled:bg-[#006600] text-black border-4 border-black text-sm flex items-center justify-center gap-3",children:n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"jsx-4af1028d542c7dd3 spin border-4 border-black border-t-[#FFD700] w-4 h-4 rounded-full"}),(0,i.jsx)("span",{className:"jsx-4af1028d542c7dd3",children:"SENDING..."})]}):"SUBMIT SCORE"}),(0,i.jsx)("button",{onClick:o,disabled:n,style:{boxShadow:"4px 4px 0px #000000"},className:"jsx-4af1028d542c7dd3 retro-button w-full px-6 py-3 bg-[#DC143C] hover:bg-[#FF0000] disabled:bg-[#660000] text-white border-4 border-black text-xs",children:"SKIP"})]}),(0,i.jsx)("div",{className:"jsx-4af1028d542c7dd3 absolute top-2 left-2 w-4 h-4 border-t-2 border-l-2 border-[#FFD700]"}),(0,i.jsx)("div",{className:"jsx-4af1028d542c7dd3 absolute top-2 right-2 w-4 h-4 border-t-2 border-r-2 border-[#FFD700]"}),(0,i.jsx)("div",{className:"jsx-4af1028d542c7dd3 absolute bottom-2 left-2 w-4 h-4 border-b-2 border-l-2 border-[#FFD700]"}),(0,i.jsx)("div",{className:"jsx-4af1028d542c7dd3 absolute bottom-2 right-2 w-4 h-4 border-b-2 border-r-2 border-[#FFD700]"})]})]})]}):null}function y(e){let{isOpen:t,title:s,message:a,type:o="info",onClose:n}=e;if(!t)return null;let l={success:{border:"#00FF41",glow:"rgba(0, 255, 65, 0.6)",text:"#00FF41",icon:"✓",buttonBg:"#00FF41",buttonText:"#000000"},error:{border:"#FF0000",glow:"rgba(255, 0, 0, 0.6)",text:"#FF0000",icon:"✕",buttonBg:"#DC143C",buttonText:"#FFFFFF"},info:{border:"#20B2AA",glow:"rgba(32, 178, 170, 0.6)",text:"#20B2AA",icon:"ℹ",buttonBg:"#20B2AA",buttonText:"#000000"},warning:{border:"#FFD700",glow:"rgba(255, 215, 0, 0.6)",text:"#FFD700",icon:"⚠",buttonBg:"#FFD700",buttonText:"#000000"}}[o];return(0,i.jsxs)("div",{className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" fixed inset-0 z-[100] flex items-center justify-center bg-black/90",children:[(0,i.jsx)(r(),{id:"b18b73d69f88e514",dynamic:[l.text,l.text,l.text],children:'@import url("https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap");.pixel-border.__jsx-style-dynamic-selector{-ms-interpolation-mode:nearest-neighbor;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:crisp-edges}.retro-button.__jsx-style-dynamic-selector{font-family:"Press Start 2P",monospace;text-shadow:3px 3px 0px#000;-ms-interpolation-mode:nearest-neighbor;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:-o-pixelated;image-rendering:pixelated;-webkit-transition:-webkit-transform.1s ease;-moz-transition:-moz-transform.1s ease;-o-transition:-o-transform.1s ease;transition:-webkit-transform.1s ease;transition:-moz-transform.1s ease;transition:-o-transform.1s ease;transition:transform.1s ease}.retro-button.__jsx-style-dynamic-selector:hover{-webkit-transform:scale(1.05);-moz-transform:scale(1.05);-ms-transform:scale(1.05);-o-transform:scale(1.05);transform:scale(1.05)}.retro-button.__jsx-style-dynamic-selector:active{-webkit-transform:scale(.98);-moz-transform:scale(.98);-ms-transform:scale(.98);-o-transform:scale(.98);transform:scale(.98)}.neon-text.__jsx-style-dynamic-selector{text-shadow:0 0 10px '.concat(l.text,",0 0 20px ").concat(l.text,",0 0 30px ").concat(l.text,",3px 3px 0px#000}.scanline.__jsx-style-dynamic-selector{background:-webkit-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:-moz-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:-o-repeating-linear-gradient(bottom,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);background:repeating-linear-gradient(0deg,rgba(0,0,0,.15),rgba(0,0,0,.15)1px,transparent 1px,transparent 2px);pointer-events:none}@-webkit-keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}@-moz-keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}@-o-keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}.pulse.__jsx-style-dynamic-selector{-webkit-animation:pulse 2s infinite;-moz-animation:pulse 2s infinite;-o-animation:pulse 2s infinite;animation:pulse 2s infinite}")}),(0,i.jsxs)("div",{style:{borderColor:l.border,boxShadow:"0 0 30px ".concat(l.glow,", inset 0 0 60px rgba(0, 0, 0, 0.8)"),fontFamily:"'Press Start 2P', monospace"},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" relative bg-[#0A0E27] border-4 p-8 max-w-md mx-4 pixel-border",children:[(0,i.jsx)("div",{className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" absolute inset-0 scanline pointer-events-none"}),(0,i.jsxs)("div",{className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" relative text-center",children:[(0,i.jsx)("div",{className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" mb-6",children:(0,i.jsx)("div",{style:{backgroundColor:l.border,boxShadow:"4px 4px 0px #000000"},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" mx-auto w-20 h-20 border-4 border-black flex items-center justify-center pixel-border pulse",children:(0,i.jsx)("span",{className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" text-4xl text-black font-bold",children:l.icon})})}),(0,i.jsx)("h2",{style:{fontFamily:"'Press Start 2P', monospace",color:l.text},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" text-xl mb-6 leading-relaxed neon-text",children:s.toUpperCase()}),(0,i.jsx)("div",{style:{borderColor:l.border,boxShadow:"inset 0 0 20px ".concat(l.glow)},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" bg-black/70 border-2 p-4 mb-6 pixel-border",children:(0,i.jsx)("p",{style:{fontFamily:"'Press Start 2P', monospace",textShadow:"2px 2px 0px #000000"},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" text-white text-[10px] leading-relaxed whitespace-pre-line",children:a.toUpperCase()})}),(0,i.jsx)("button",{onClick:n,style:{backgroundColor:l.buttonBg,color:l.buttonText,boxShadow:"6px 6px 0px #000000"},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" retro-button w-full px-6 py-4 border-4 border-black text-sm",children:"OK"}),(0,i.jsx)("div",{style:{borderColor:l.border},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" absolute top-2 left-2 w-4 h-4 border-t-2 border-l-2"}),(0,i.jsx)("div",{style:{borderColor:l.border},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" absolute top-2 right-2 w-4 h-4 border-t-2 border-r-2"}),(0,i.jsx)("div",{style:{borderColor:l.border},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" absolute bottom-2 left-2 w-4 h-4 border-b-2 border-l-2"}),(0,i.jsx)("div",{style:{borderColor:l.border},className:r().dynamic([["b18b73d69f88e514",[l.text,l.text,l.text]]])+" absolute bottom-2 right-2 w-4 h-4 border-b-2 border-r-2"})]})]})]})}class x extends n.Scene{preload(){this.load.image("zombie_character","/assets/zombie_character.png"),this.load.image("stacy_character","/images/stacy-select.png"),this.load.image("red_sky_bg","/assets/red_sky_bg.png"),this.load.image("zombie_idle","/images/zombie-idle.png"),this.load.image("zombie_jump","/sprites/jump_static.png"),this.load.image("zombie_trick","/sprites/trick_sprite.png"),this.load.image("stacy_idle","/images/stacy_idle.png"),this.load.image("stacy_jump","/images/stacy_jump.png"),this.load.image("stacy_trick","/images/stacy_trick.png"),this.load.image("skater_idle","/assets/skater_idle.png"),this.load.image("skater_jump","/assets/skater_idle.png"),this.load.image("skater_trick","/assets/skater_idle.png"),this.load.image("jump_static","/sprites/jump_static.png"),this.load.image("trick_sprite","/sprites/trick_sprite.png"),this.load.image("obstacle_cone","/assets/obstacle_cone.png"),this.load.image("obstacle_trash","/assets/obstacle_trash.png"),this.load.image("obstacle_crash","/assets/obstacle_crash.png"),this.load.image("obstacle_zombie","/assets/obstacle_zombie.png"),this.load.image("obstacle_skulls","/assets/obstacle_skulls.png"),this.load.image("enemy_eyeball","/assets/enemy_eyeball.png"),this.load.image("enemy_robot","/assets/enemy_robot.png"),this.load.image("enemy_robot2","/assets/enemy_robot2.png"),this.load.image("enemy_robot3","/assets/enemy_robot3.png"),this.load.image("explosion","/assets/explosion.png"),this.load.image("arrow_indicator","/assets/arrow_indicator.png"),this.load.image("warning_triangle","/assets/warning_triangle.png"),this.load.image("heart","/assets/heart.png"),this.load.image("life_icon","/assets/life_icon.png"),this.load.image("sandwich","/assets/sandwich.png"),this.load.image("energy_drink","/assets/energy_drink.png"),this.load.image("energy_warning","/assets/energy_warning.png"),this.load.image("maximum_text","/assets/maximum_text.png"),this.load.image("metal_boot","/assets/metal_boot.png"),this.load.image("metal_skateboard","/images/metal_skateboard_boot.png"),this.load.image("fire_taco","/assets/fire_taco.png"),this.load.image("fire_breath","/assets/fire_breath.png"),this.load.image("crystal_magnet","/assets/crystal_magnet.png"),this.load.image("fire1","/images/fire1.png"),this.load.image("fire2","/images/fire2.png"),this.load.image("exclamation_mark","/assets/exclamation.png"),this.load.image("powerup_cross","/assets/powerup_cross.png"),this.load.image("fingerprint","/images/fingerprint.png"),this.load.image("boss_ship1","/boss_ship1.png"),this.load.image("boss_ship2","/boss_ship2.png"),this.load.image("boss_ship3","/boss_ship3.png"),this.load.image("my_lead_foot_text","/assets/my_lead_foot_text.png"),this.load.image("heavy_metal_ride_text","/images/heavy_metal_ride_text.png"),this.load.image("stay_lit_text","/assets/stay_lit_text.png"),this.load.image("get_over_here_text","/assets/get_over_here_text.png"),this.load.image("game_over_bg","/assets/game_over_bg.png"),this.load.image("star_icon","/assets/star_icon.png"),this.load.image("star_counter_icon","/assets/star_counter_icon.png"),this.load.image("star_single","/assets/star_single.png"),this.load.image("star_ten","/assets/star_ten.png"),this.load.image("sandwich_arrow","/assets/sandwich_arrow.png"),this.load.image("city_background","/assets/city_background.png"),this.load.image("slime_splash","/assets/slime_splash.png"),this.load.image("soul_arcade","/assets/soul_arcade.png"),this.load.image("soul_arcade_logo","/assets/soul_arcade_logo.png"),this.load.image("soul_arcade_new_logo","/assets/soul_arcade_new_logo.png"),this.load.image("warning_skull","/assets/warning_skull.png"),this.load.image("starfall_presents","/assets/starfall_presents.png"),this.load.image("graffiti_bg","/assets/graffiti_bg.png"),this.load.image("menu_background","/assets/menu_background.png"),this.load.image("play_button","/assets/play_button.png"),this.load.image("options_button","/assets/options_button.png"),this.load.audio("menu_music","/assets/menu_music.m4a"),this.load.audio("broken_code","/assets/broken_code.m4a"),this.load.audio("undead_empire","/assets/undead_empire.m4a"),this.load.audio("star_single_sfx","/assets/star_single_sfx.wav"),this.load.audio("star_cluster_sfx","/assets/star_cluster_sfx.wav"),this.load.audio("bite_sfx","/assets/bite_sfx.m4a"),this.load.audio("energy_drink_sfx","/assets/energy_drink_sfx.wav"),this.load.audio("enemy_explosion","/sounds/enemy_explosion.m4a"),this.load.audio("combo_sfx","/sounds/combo.m4a"),this.load.audio("jump_sfx","/sounds/jump.m4a"),this.load.audio("new_explosion_sfx","/sounds/new_explosion.m4a"),this.load.audio("new_star_sfx","/sounds/new_star_single.m4a")}create(){let e=this.add.graphics();e.fillStyle(16777215),e.fillRect(0,0,4,4),e.generateTexture("pixel",4,4),e.destroy(),this.anims.create({key:"skate",frames:[{key:"skater_idle"}],frameRate:8,repeat:-1}),this.anims.create({key:"jump",frames:[{key:"skater_jump"}],frameRate:8,repeat:0}),this.anims.create({key:"trick",frames:[{key:"skater_trick"}],frameRate:8,repeat:0}),this.scene.start("Splash1")}constructor(){super("Preload")}}class b extends Phaser.Scene{create(){this.cameras.main.setBackgroundColor("#000000");let e=this.cameras.main.width/2,t=this.cameras.main.height/2,s=this.add.image(e,t,"soul_arcade_new_logo");s.setOrigin(.5,.5);let i=Math.min(1600/s.width,1400/s.height);s.setScale(i),this.time.delayedCall(2e3,()=>{let a=this.add.image(e,t,"soul_arcade_new_logo");a.setOrigin(.5,.5),a.setScale(i),a.setAlpha(0),a.setBlendMode(Phaser.BlendModes.ADD),a.setTint(16777215);let r=this.make.graphics({}),o=s.x-s.displayWidth/2-150;r.fillStyle(16777215),r.fillRect(o,s.y-s.displayHeight/2,150,s.displayHeight);let n=r.createGeometryMask();a.setMask(n),a.setAlpha(.6),this.tweens.add({targets:{x:o},x:s.x+s.displayWidth/2+150,duration:800,ease:"Power2",onUpdate:e=>{let t=e.targets[0];r.clear(),r.fillStyle(16777215);for(let e=0;e<10;e++){let i=1-e/10;r.fillStyle(16777215,i),r.fillRect(t.x+150*e/10,s.y-s.displayHeight/2,15,s.displayHeight)}},onComplete:()=>{a.destroy(),r.destroy(),this.time.delayedCall(500,()=>{this.scene.start("Splash2")})}})})}constructor(){super({key:"Splash1"})}}class S extends Phaser.Scene{create(){var e;this.cameras.main.setBackgroundColor("#000000");let t=this.cameras.main.width/2,s=this.cameras.main.height/2,i=this.add.image(t,s,"warning_skull");i.setOrigin(.5,.5),i.setDisplaySize(640,960),this.skipTimer=this.time.delayedCall(2e3,()=>{this.scene.start("Splash3")}),null===(e=this.input.keyboard)||void 0===e||e.on("keydown",()=>{this.skipToNext()}),this.input.on("pointerdown",()=>{this.skipToNext()})}skipToNext(){var e;this.skipTimer&&this.skipTimer.destroy(),null===(e=this.input.keyboard)||void 0===e||e.removeAllListeners(),this.input.removeAllListeners(),this.scene.start("Splash3")}constructor(){super({key:"Splash2"})}}class w extends Phaser.Scene{create(){var e;this.cameras.main.setBackgroundColor("#000000");let t=this.cameras.main.width/2,s=this.cameras.main.height/2,i=this.add.image(t,s,"warning_skull");i.setOrigin(.5,.5),i.setDisplaySize(640,960),this.skipTimer=this.time.delayedCall(2e3,()=>{this.scene.start("Splash4")}),null===(e=this.input.keyboard)||void 0===e||e.on("keydown",()=>{this.skipToNext()}),this.input.on("pointerdown",()=>{this.skipToNext()})}skipToNext(){var e;this.skipTimer&&this.skipTimer.destroy(),null===(e=this.input.keyboard)||void 0===e||e.removeAllListeners(),this.input.removeAllListeners(),this.scene.start("Splash4")}constructor(){super({key:"Splash3"})}}class T extends Phaser.Scene{create(){var e;this.cameras.main.setBackgroundColor("#000000");let t=this.cameras.main.width/2,s=this.cameras.main.height/2,i=this.add.image(t,s,"slime_splash");i.setOrigin(.5,.5),i.setScale(.5),this.skipTimer=this.time.delayedCall(2e3,()=>{this.scene.start("Splash5")}),null===(e=this.input.keyboard)||void 0===e||e.on("keydown",()=>{this.skipToNext()}),this.input.on("pointerdown",()=>{this.skipToNext()})}skipToNext(){var e;this.skipTimer&&this.skipTimer.destroy(),null===(e=this.input.keyboard)||void 0===e||e.removeAllListeners(),this.input.removeAllListeners(),this.scene.start("Splash5")}constructor(){super({key:"Splash4"})}}class v extends Phaser.Scene{create(){var e;this.cameras.main.setBackgroundColor("#000000");let t=this.cameras.main.width/2,s=this.cameras.main.height/2,i=this.add.image(t,s,"starfall_presents");i.setOrigin(.5,.5),i.setDisplaySize(640,960),this.skipTimer=this.time.delayedCall(2e3,()=>{this.scene.start("MainMenu")}),null===(e=this.input.keyboard)||void 0===e||e.on("keydown",()=>{this.skipToNext()}),this.input.on("pointerdown",()=>{this.skipToNext()})}skipToNext(){var e;this.skipTimer&&this.skipTimer.destroy(),null===(e=this.input.keyboard)||void 0===e||e.removeAllListeners(),this.input.removeAllListeners(),this.scene.start("MainMenu")}constructor(){super({key:"Splash5"})}}class k extends Phaser.Scene{init(e){e.menuMusic&&(this.menuMusic=e.menuMusic)}create(){let e=this.cameras.main;if(this.sound.stopAll(),this.game.sound.stopAll(),this.game.sound.getAllPlaying().forEach(e=>{"menu_music"===e.key&&(e.stop(),e.destroy())}),window.menuMusicInstance&&!this.sound.get("menu_music")){try{window.menuMusicInstance.stop(),window.menuMusicInstance.destroy()}catch(e){}window.menuMusicInstance=void 0,window.menuMusicStarted=!1}window.menuMusicStarted?window.menuMusicInstance&&(this.menuMusic=window.menuMusicInstance,this.menuMusic.isPlaying||this.menuMusic.play()):(window.menuMusicStarted=!0,this.menuMusic=this.sound.add("menu_music",{loop:!0,volume:.5}),window.menuMusicInstance=this.menuMusic,this.menuMusic.play(),console.log("Menu music started - FIRST AND ONLY TIME"));let t=this.add.image(e.centerX,e.centerY,"menu_background"),s=Math.max(e.width/t.width,e.height/t.height);t.setScale(s).setScrollFactor(0);let i=.4*e.width,a=this.add.image(e.centerX,.82*e.height,"play_button").setOrigin(.5),r=this.add.image(e.centerX,.92*e.height,"options_button").setOrigin(.5),o=Math.min(i/a.width,.8),n=Math.min(i/r.width,.8);a.setScale(o),r.setScale(n),this.buttonBaseScales=[o,n],this.menuItems=[a,r],a.setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.selectItem(0),this.confirmSelection()}),r.setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.selectItem(1),this.confirmSelection()}),this.cursors=this.input.keyboard.createCursorKeys(),this.enterKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER),this.updateSelection()}update(){Phaser.Input.Keyboard.JustDown(this.cursors.up)?(this.selectedIndex=(this.selectedIndex-1+this.menuItems.length)%this.menuItems.length,this.updateSelection()):Phaser.Input.Keyboard.JustDown(this.cursors.down)?(this.selectedIndex=(this.selectedIndex+1)%this.menuItems.length,this.updateSelection()):(Phaser.Input.Keyboard.JustDown(this.cursors.space)||Phaser.Input.Keyboard.JustDown(this.enterKey))&&this.confirmSelection()}selectItem(e){this.selectedIndex=e,this.updateSelection()}updateSelection(){this.menuItems.forEach((e,t)=>{let s=this.buttonBaseScales[t];t===this.selectedIndex?(e.setScale(1.2*s),e.setTint(16776960)):(e.setScale(s),e.clearTint())})}confirmSelection(){0===this.selectedIndex?this.scene.start("CharacterSelect",{menuMusic:this.menuMusic}):1===this.selectedIndex&&this.scene.start("OptionsMenu",{menuMusic:this.menuMusic})}constructor(){super({key:"MainMenu"}),this.selectedIndex=0,this.menuItems=[],this.buttonBaseScales=[]}}class C extends n.Scene{init(e){this.menuMusic=e.menuMusic||null}create(){let e=this.cameras.main;this.add.image(e.centerX,e.centerY,"graffiti_bg").setDisplaySize(e.width,e.height),this.add.text(e.centerX,100,"SELECT CHARACTER",{fontSize:"24px",color:"#ffecb3",fontFamily:'"Press Start 2P", monospace'}).setOrigin(.5);let t=()=>{if(console.log("Stake confirmed! Starting game..."),!window.selectedCharacter){console.log("No character selected yet, waiting...");return}if(window.removeEventListener("stakeConfirmed",t),this.sound.stopAll(),this.game.sound.stopAll(),window.menuMusicInstance){try{window.menuMusicInstance.stop(),window.menuMusicInstance.destroy()}catch(e){}window.menuMusicInstance=void 0,window.menuMusicStarted=!1}console.log("Transitioning to Game scene with character:",window.selectedCharacter),this.scene.start("Game",{selectedCharacter:window.selectedCharacter})};console.log("CharacterSelect: Setting up stakeConfirmed listener"),window.addEventListener("stakeConfirmed",t),this.events.on("shutdown",()=>{window.removeEventListener("stakeConfirmed",t)});let s=this.add.container(e.centerX-140,e.centerY),i=this.add.graphics();i.lineStyle(4,16711680),i.strokeRect(-100,-100,200,200);let a=this.add.image(0,0,"zombie_character");a.setScale(.25),a.setInteractive({useHandCursor:!0}),s.add([i,a]);let r=this.add.text(e.centerX-140,e.centerY+150,"KEV",{fontSize:"22px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace'}).setOrigin(.5),o=this.add.container(e.centerX+140,e.centerY),n=this.add.graphics();n.lineStyle(4,16711680),n.strokeRect(-100,-100,200,200);let l=this.add.image(0,0,"stacy_character");l.setScale(.25),l.setInteractive({useHandCursor:!0}),l.on("pointerdown",()=>{this.selectedIndex=1,this.confirmSelection()});let h=this.add.text(e.centerX+140,e.centerY+150,"STACY",{fontSize:"22px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace'}).setOrigin(.5);o.add([n,l]),this.characters=[{container:s,image:a,name:r},{container:o,image:l,name:h}],this.cursors=this.input.keyboard.createCursorKeys(),a.on("pointerdown",()=>{this.selectedIndex=0,this.confirmSelection()}),this.updateSelection();let c=this.add.text(e.centerX,e.height-80,"MAIN MENU",{fontSize:"16px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',backgroundColor:"#333333",padding:{x:20,y:10}}).setOrigin(.5);c.setInteractive({useHandCursor:!0}),c.on("pointerover",()=>{c.setColor("#00ff00"),c.setScale(1.1)}),c.on("pointerout",()=>{c.setColor("#ffffff"),c.setScale(1)}),c.on("pointerdown",()=>{this.scene.start("MainMenu",{menuMusic:this.menuMusic})})}update(){this.cursors&&(n.Input.Keyboard.JustDown(this.cursors.left)?(this.selectedIndex=0,this.updateSelection()):n.Input.Keyboard.JustDown(this.cursors.right)&&(this.selectedIndex=1,this.updateSelection()),(n.Input.Keyboard.JustDown(this.cursors.space)||n.Input.Keyboard.JustDown(this.input.keyboard.addKey("ENTER")))&&this.confirmSelection(),n.Input.Keyboard.JustDown(this.input.keyboard.addKey("ESC"))&&this.scene.start("MainMenu",{menuMusic:this.menuMusic}))}updateSelection(){this.characters.forEach((e,t)=>{t===this.selectedIndex?(e.name.setColor("#ffff00"),e.name.setScale(1.2),e.image.setTint(16777130)):(e.name.setColor("#ffffff"),e.name.setScale(1),e.image.clearTint())})}confirmSelection(){let e=0===this.selectedIndex?"kev":"stacy";window.selectedCharacter=e,console.log("Character selected:",e,"- Dispatching gameStartRequested"),window.dispatchEvent(new CustomEvent("gameStartRequested"))}constructor(){super("CharacterSelect"),this.selectedIndex=0,this.characters=[],this.menuMusic=null}}class E extends n.Events.EventEmitter{resetCombo(){this.state={status:"inactive",airEventCount:0,multiplier:0,startScore:0,comboScorePoints:0,lastEventTime:0,obstaclesClearedInTrick:0,starsCollectedDuringCombo:0,trickObstacles:[]}}registerTrick(e,t,s){if(t){console.log("[COMBO] Trick ignored - player is grounded");return}s&&(this.state.trickObstacles.push(s),this.state.obstaclesClearedInTrick++),this.registerAirEvent(e),console.log("[COMBO] Trick registered - airEventCount: ".concat(this.state.airEventCount,", obstacles: ").concat(this.state.obstaclesClearedInTrick))}registerEnemyKill(e,t){if(t){console.log("[COMBO] Enemy kill ignored - player is grounded");return}this.registerAirEvent(e),console.log("[COMBO] Enemy kill registered - airEventCount: ".concat(this.state.airEventCount))}registerAirEvent(e){try{let t=this.scene.time.now;if("inactive"===this.state.status)this.state.status="pending",this.state.startScore=e,this.state.airEventCount=1,this.state.lastEventTime=t,console.log("[COMBO] Started pending combo");else if("pending"===this.state.status){if(this.state.airEventCount++,this.state.lastEventTime=t,this.state.airEventCount>=3){this.state.status="active",this.state.multiplier=3,console.log("[COMBO] COMBO ACTIVATED! Bonus: +3"),console.log("[DEBUG COMBO] Combo activated - state:",this.state);try{this.emit("comboActivated",{multiplier:this.state.multiplier}),console.log("[DEBUG COMBO] Combo activated event emitted successfully")}catch(e){console.error("[DEBUG COMBO] Error emitting comboActivated:",e)}}}else if("active"===this.state.status){this.state.multiplier+=2,this.state.lastEventTime=t,console.log("[COMBO] Combo updated - bonus: +".concat(this.state.multiplier));let s=e-this.state.startScore;try{this.emit("comboUpdated",{multiplier:this.state.multiplier,scorePoints:s}),console.log("[DEBUG COMBO] Combo updated event emitted successfully")}catch(e){console.error("[DEBUG COMBO] Error emitting comboUpdated:",e)}}}catch(e){console.error("[DEBUG COMBO] Critical error in registerAirEvent:",e),this.resetCombo()}}updateAirState(e,t,s){return!t&&s?this.handleLanding(e):("active"===this.state.status&&(this.state.comboScorePoints=e-this.state.startScore,this.emit("comboUpdated",{multiplier:this.state.multiplier,scorePoints:this.state.comboScorePoints})),0)}handleLanding(e){try{if("inactive"===this.state.status)return 0;let t=0;if("active"===this.state.status){this.state.comboScorePoints=e-this.state.startScore;let s=this.state.starsCollectedDuringCombo,i=this.state.multiplier;t=s+i,console.log("[COMBO] COMBO COMPLETED! Score Points: ".concat(this.state.comboScorePoints,", Stars Collected: ").concat(this.state.starsCollectedDuringCombo,", Base Stars: ").concat(s,", Bonus Stars: +").concat(i,", Total Stars: ").concat(t)),console.log("[DEBUG COMBO] Combo ending - state before reset:",this.state);try{this.emit("comboEnded",{multiplier:this.state.multiplier,scorePoints:this.state.comboScorePoints,starsEarned:t}),console.log("[DEBUG COMBO] Combo ended event emitted successfully")}catch(e){console.error("[DEBUG COMBO] Error emitting comboEnded:",e)}}else console.log("[COMBO] Landing ended pending combo (less than 3 events)");return this.resetCombo(),t}catch(e){return console.error("[DEBUG COMBO] Critical error in handleLanding:",e),this.resetCombo(),0}}getComboState(){return{...this.state}}isActive(){return"active"===this.state.status}isPending(){return"pending"===this.state.status}hasCombo(){return"inactive"!==this.state.status}addStarsToCombo(e){("active"===this.state.status||"pending"===this.state.status)&&(this.state.starsCollectedDuringCombo+=e,console.log("[COMBO] Added ".concat(e," stars to combo. Total: ").concat(this.state.starsCollectedDuringCombo)))}getTrickObstacles(){return[...this.state.trickObstacles]}clearTrickObstacles(){this.state.trickObstacles=[],this.state.obstaclesClearedInTrick=0}constructor(e){super(),this.state={status:"inactive",airEventCount:0,multiplier:0,startScore:0,comboScorePoints:0,lastEventTime:0,obstaclesClearedInTrick:0,starsCollectedDuringCombo:0,trickObstacles:[]},this.scene=e,this.resetCombo()}}class P{showMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,s=arguments.length>2?arguments[2]:void 0;this.messageTimer&&(this.messageTimer.remove(),this.messageTimer=void 0),this.messageText.setText(e),this.messageText.setVisible(!0),this.messageText.setAlpha(1),s&&s>0?(this.starText.setText("+".concat(s," STAR").concat(s>1?"S":"")),this.starText.setVisible(!0),this.starText.setAlpha(1)):this.starText.setVisible(!1),this.messageText.setScale(0),this.starText.setScale(0),this.scene.tweens.add({targets:[this.messageText,this.starText],scale:1,duration:200,ease:"Back.easeOut"}),this.messageTimer=this.scene.time.addEvent({delay:t,callback:()=>{this.scene.tweens.add({targets:[this.messageText,this.starText],alpha:0,scale:.8,duration:200,onComplete:()=>{this.messageText.setVisible(!1),this.starText.setVisible(!1)}})}})}addMessage(e,t){this.showMessage(e,1500,t)}addPriorityMessage(e,t,s){this.showMessage(e,s||3e3)}addPowerUpMessage(e){let t=e;"power_metal"===e&&(t="Metal Boot!"),"power_fire"===e&&(t="Fire Taco!"),"power_crystal"===e&&(t="Crystal Magnet!"),this.showMessage(t)}update(e,t){}processComboState(e){"active"===e.status&&this.showMessage("COMBO x".concat(e.multiplier,"!"))}onComboEnded(e){let t=e.starsEarned||0;t>0&&this.showMessage("COMBO! +".concat(t," STARS"))}destroy(){this.messageTimer&&this.messageTimer.remove(),this.messageText&&this.messageText.destroy(),this.starText&&this.starText.destroy()}cleanup(){this.destroy()}constructor(e){this.messageY=300,this.scene=e,this.messageText=this.scene.add.text(320,this.messageY,"",{fontSize:"24px",fontFamily:'"Press Start 2P", monospace',color:"#ffd700",stroke:"#000000",strokeThickness:4}),this.messageText.setOrigin(.5),this.messageText.setDepth(110),this.messageText.setScrollFactor(0),this.messageText.setVisible(!1),this.starText=this.scene.add.text(320,this.messageY+35,"",{fontSize:"18px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff",stroke:"#000000",strokeThickness:4}),this.starText.setOrigin(.5),this.starText.setDepth(110),this.starText.setScrollFactor(0),this.starText.setVisible(!1)}}class _{reset(){this.currentWave=1,this.speedIncreases=0,this.challengesCompleted=0,this.waveStartTime=Date.now(),this.lastSpeedIncreaseTime=Date.now(),this.speedMultiplier=this.baseSpeed,this.isTransitioning=!1}update(e){if(this.isTransitioning)return}increaseSpeed(){this.speedIncreases++,this.lastSpeedIncreaseTime=Date.now(),this.speedMultiplier+=.15,this.onSpeedIncrease&&this.onSpeedIncrease(this.speedMultiplier)}completeChallenge(){console.log("[DEBUG WAVE] CompleteChallenge called - All challenges for wave complete!"),console.log("[DEBUG WAVE] Current state:",{wave:this.currentWave,challengesCompleted:this.challengesCompleted,speedMultiplier:this.speedMultiplier,isTransitioning:this.isTransitioning}),this.challengesCompleted=3;try{console.log("[DEBUG WAVE] Increasing speed..."),this.increaseSpeed()}catch(e){console.error("[DEBUG WAVE] Error during speed increase:",e)}try{console.log("[DEBUG WAVE] All challenges complete, advancing to next wave"),this.advanceWave()}catch(e){console.error("[DEBUG WAVE] Error advancing wave:",e)}}advanceWave(){this.currentWave>=3?this.triggerVictory():(this.isTransitioning=!0,this.currentWave++,this.speedIncreases=0,this.challengesCompleted=0,this.waveStartTime=Date.now(),this.lastSpeedIncreaseTime=Date.now(),this.speedMultiplier+=.1,this.onWaveChange&&this.onWaveChange(this.currentWave),this.showWaveTransition())}triggerVictory(){this.isTransitioning=!0;let e=this.scene;e.showVictoryScreen&&e.showVictoryScreen()}triggerEndGame(){this.isTransitioning=!0,this.speedMultiplier=this.baseSpeed,this.onSpeedIncrease&&this.onSpeedIncrease(this.speedMultiplier)}showNotification(e){let t=this.scene.add.text(320,200,e,{fontSize:"24px",color:"#ffeb3b",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:4}).setOrigin(.5);t.setScrollFactor(0),t.setDepth(200),this.scene.tweens.add({targets:t,y:150,alpha:0,duration:2e3,ease:"Power2",onComplete:()=>t.destroy()})}showWaveTransition(){let e=3===this.currentWave?"FINAL WAVE":"WAVE ".concat(this.currentWave),t=this.scene.add.text(320,480,e,{fontSize:"48px",color:"#ff6b6b",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:6}).setOrigin(.5);t.setScrollFactor(0),t.setDepth(250),t.setScale(0),this.scene.tweens.add({targets:t,scaleX:1,scaleY:1,duration:500,ease:"Back.easeOut",onComplete:()=>{this.scene.time.delayedCall(1500,()=>{this.scene.tweens.add({targets:t,alpha:0,duration:500,onComplete:()=>{t.destroy(),this.isTransitioning=!1}})})}}),this.showUnlockedItems()}showUnlockedItems(){this.getCurrentWaveConfig(),2===this.currentWave?this.showUnlockText("GET READY FOR CARNAGE",540):3===this.currentWave&&this.showUnlockText("SURVIVE TO WIN!",540)}showUnlockText(e,t){let s=this.scene.add.text(320,t,e,{fontSize:"16px",color:"#4caf50",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}).setOrigin(.5);s.setScrollFactor(0),s.setDepth(240),s.setAlpha(0),this.scene.tweens.add({targets:s,alpha:1,duration:300,delay:500,onComplete:()=>{this.scene.time.delayedCall(2e3,()=>{this.scene.tweens.add({targets:s,alpha:0,duration:300,onComplete:()=>s.destroy()})})}})}getCurrentWaveConfig(){let e=this.waveConfigs[this.currentWave]||this.waveConfigs[1];return{waveNumber:this.currentWave,speedIncreases:this.speedIncreases,challengesCompleted:this.challengesCompleted,isTransitioning:this.isTransitioning,isComplete:this.currentWave>3,...e}}getSpeedMultiplier(){return this.speedMultiplier}isObstacleUnlocked(e){return this.getCurrentWaveConfig().unlockedObstacles.includes(e)}isPowerUpUnlocked(e){return this.getCurrentWaveConfig().unlockedPowerUps.includes(e)}isEnemyUnlocked(e){return this.getCurrentWaveConfig().unlockedEnemies.includes(e)}setOnWaveChange(e){this.onWaveChange=e}setOnSpeedIncrease(e){this.onSpeedIncrease=e}isWaveComplete(){return this.currentWave>3}getCurrentWave(){return this.currentWave}constructor(e){this.currentWave=1,this.speedIncreases=0,this.lastSpeedIncreaseTime=0,this.waveStartTime=0,this.challengesCompleted=0,this.isTransitioning=!1,this.baseSpeed=1,this.speedMultiplier=1,this.waveConfigs={1:{unlockedObstacles:["obstacle_trash"],unlockedPowerUps:[],unlockedEnemies:["enemy_robot"],totalChallenges:3},2:{unlockedObstacles:["obstacle_trash","obstacle_cone"],unlockedPowerUps:["fire_taco"],unlockedEnemies:["enemy_robot","enemy_eyeball","enemy_robot2"],totalChallenges:3},3:{unlockedObstacles:["obstacle_trash","obstacle_cone","obstacle_skulls"],unlockedPowerUps:["fire_taco","metal_skateboard","crystal_magnet"],unlockedEnemies:["enemy_robot","enemy_eyeball","enemy_robot2","enemy_robot3"],totalChallenges:3}},this.scene=e,this.reset()}}class M{generateChallengesForWave(e){let t=this.availableChallengesByWave[e]||this.availableChallengesByWave[1],s=this.shuffleArray([...t]),i=["survive_time","no_damage"];1===e&&0===this.challenges.length&&(s=s.filter(e=>!i.includes(e)));let a=[];for(let e=0;e<3&&a.length<3;e++){let t=s[e];if(this.recentChallenges.includes(t)&&s.length>3){let e=s.find(e=>!this.recentChallenges.includes(e)&&!a.includes(e));e&&(t=e)}a.includes(t)||a.push(t)}if(1===e&&a.length<3)for(let e of i)t.includes(e)&&!a.includes(e)&&a.length<3&&a.push(e);for(;a.length<3&&s.length>a.length;){let e=s.find(e=>!a.includes(e));if(e)a.push(e);else break}this.recentChallenges=[...this.recentChallenges,...a].slice(-4);let r=this.shuffleArray(a);if(1===e&&0===this.challenges.length&&i.includes(r[0])){let e=r.findIndex(e=>!i.includes(e));e>0&&([r[0],r[e]]=[r[e],r[0]])}return this.activeChallenges=r.map((t,s)=>{let i=(this.challengeParams[t][e]||this.challengeParams[t][1]).target,a=this.formatDescription(t,i);return{id:"wave".concat(e,"_challenge").concat(s+1),type:t,description:a,target:i,current:0,completed:!1,waveNumber:e}}),this.startTime=this.scene.time.now,this.activeChallenges}shuffleArray(e){let t=[...e],s=Date.now()%1e3;for(let e=t.length-1;e>0;e--){let i=Math.floor((Math.random()+s/1e3)*(e+1))%(e+1);[t[e],t[i]]=[t[i],t[e]]}return t}formatDescription(e,t){switch(e){case"collect_stars":return"Collect ".concat(t," Stars");case"stomp_enemies":return"Crush ".concat(t," Enemies");case"survive_time":return"Survive ".concat(t," Seconds");case"get_combo":return"Get ".concat(t,"x Combo");case"no_damage":return"No Damage for ".concat(t,"s");case"perform_tricks":return"Perform ".concat(t," Tricks");default:return"Complete Challenge"}}updateChallenge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;console.log("[DEBUG CHALLENGE] updateChallenge called:",e,t),console.log("[DEBUG CHALLENGE] Active challenges count:",this.activeChallenges.length),this.activeChallenges.length>0&&console.log("[DEBUG CHALLENGE] Active challenges:",this.activeChallenges.map(e=>({type:e.type,completed:e.completed,current:e.current,target:e.target})));let s=this.activeChallenges.find(e=>!e.completed);if(!s){console.log("[DEBUG CHALLENGE] No active/incomplete challenge found");return}if(s.type===e){if("survive_time"===e||"no_damage"===e){console.error("[CHALLENGE BUG] updateChallenge called for time-based challenge ".concat(e,"! This should not happen."));return}"perform_tricks"===e&&console.log("[DEBUG CHALLENGE] Updating perform_tricks: current=".concat(s.current,", adding=").concat(t,", will be=").concat(s.current+t)),s.current+=t,s.current>=s.target&&!s.completed&&(s.completed=!0,s.current=s.target,this.onChallengeCompleted(s))}}updateTimeChallenges(){if(0===this.startTime||0===this.activeChallenges.length)return;let e=Math.floor((this.scene.time.now-this.startTime)/1e3),t=this.activeChallenges.find(e=>!e.completed);t&&"survive_time"===t.type&&(t.current=e,t.current>=t.target&&(t.completed=!0,t.current=t.target,this.onChallengeCompleted(t)))}resetNoDamageChallenge(){let e=this.activeChallenges.find(e=>!e.completed);e&&"no_damage"===e.type&&(e.current=0,this.startTime=this.scene.time.now)}resetSurviveChallenge(){let e=this.activeChallenges.find(e=>!e.completed);e&&"survive_time"===e.type&&(e.current=0,this.startTime=this.scene.time.now)}updateNoDamageChallenge(){if(0===this.startTime||0===this.activeChallenges.length)return;let e=Math.floor((this.scene.time.now-this.startTime)/1e3),t=this.activeChallenges.find(e=>!e.completed);t&&"no_damage"===t.type&&(t.current=e,t.current>=t.target&&(t.completed=!0,t.current=t.target,this.onChallengeCompleted(t)))}onChallengeCompleted(e){console.log("[DEBUG CHALLENGE] Challenge completed:",e),console.log("[DEBUG CHALLENGE] Active challenges:",this.activeChallenges.map(e=>({type:e.type,completed:e.completed,current:e.current,target:e.target})));try{console.log("[DEBUG CHALLENGE] Showing completion notification"),this.showChallengeComplete(e)}catch(e){console.error("[DEBUG CHALLENGE] Error showing completion:",e)}if(this.scene.updateChallengeDisplay&&this.scene.updateChallengeDisplay(),this.onChallengeComplete)try{console.log("[DEBUG CHALLENGE] Calling onChallengeComplete callback"),this.onChallengeComplete(e)}catch(e){console.error("[DEBUG CHALLENGE] Error in onChallengeComplete callback:",e)}let t=this.activeChallenges.find(e=>!e.completed);t&&("survive_time"===t.type||"no_damage"===t.type)&&(console.log("[DEBUG CHALLENGE] Resetting timer for next challenge:",t.type),this.startTime=this.scene.time.now,t.current=0);let s=this.activeChallenges.every(e=>e.completed);if(console.log("[DEBUG CHALLENGE] All challenges complete?",s),s&&this.onAllChallengesComplete)try{console.log("[DEBUG CHALLENGE] Calling onAllChallengesComplete"),this.onAllChallengesComplete()}catch(e){console.error("[DEBUG CHALLENGE] Error in onAllChallengesComplete:",e)}}showChallengeComplete(e){let t=this.scene;if(t.trickMessageManager&&t.trickMessageManager.addPriorityMessage)t.trickMessageManager.addPriorityMessage("CHALLENGE COMPLETE!",e.description,4e3);else{let t=this.scene.add.text(320,300,"CHALLENGE COMPLETE!",{fontSize:"20px",color:"#4caf50",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:4}).setOrigin(.5);t.setScrollFactor(0),t.setDepth(200);let s=this.scene.add.text(320,330,e.description,{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}).setOrigin(.5);s.setScrollFactor(0),s.setDepth(200),[t,s].forEach(e=>{e.setScale(0),this.scene.tweens.add({targets:e,scaleX:1,scaleY:1,duration:300,ease:"Back.easeOut",onComplete:()=>{this.scene.time.delayedCall(4e3,()=>{this.scene.tweens.add({targets:e,alpha:0,duration:500,onComplete:()=>e.destroy()})})}})})}}getActiveChallenges(){return this.activeChallenges}getStartTime(){return this.startTime}resetStartTime(){this.startTime=this.scene.time.now}getCompletedCount(){return this.activeChallenges.filter(e=>e.completed).length}reset(){this.activeChallenges=[],this.challenges=[],this.startTime=this.scene.time.now}setOnChallengeComplete(e){this.onChallengeComplete=e}setOnAllChallengesComplete(e){this.onAllChallengesComplete=e}constructor(e){this.challenges=[],this.activeChallenges=[],this.startTime=0,this.availableChallengesByWave={1:["collect_stars","perform_tricks","no_damage","get_combo","stomp_enemies","survive_time"],2:["stomp_enemies","collect_stars","get_combo","perform_tricks","no_damage","survive_time"],3:["stomp_enemies","collect_stars","get_combo","perform_tricks","no_damage","survive_time"]},this.recentChallenges=[],this.challengeParams={collect_stars:{1:{description:"Collect 30 Stars",target:30},2:{description:"Collect 50 Stars",target:50},3:{description:"Collect 75 Stars",target:75}},stomp_enemies:{1:{description:"Crush 3 Enemies",target:3},2:{description:"Crush 5 Enemies",target:5},3:{description:"Crush 8 Enemies",target:8}},survive_time:{1:{description:"Survive 30 Seconds",target:30},2:{description:"Survive 45 Seconds",target:45},3:{description:"Survive 60 Seconds",target:60}},get_combo:{1:{description:"Get 3x Combo",target:3},2:{description:"Get 4x Combo",target:4},3:{description:"Get 5x Combo",target:5}},no_damage:{1:{description:"No Damage for 15s",target:15},2:{description:"No Damage for 20s",target:20},3:{description:"No Damage for 30s",target:30}},perform_tricks:{1:{description:"Perform 5 Tricks",target:5},2:{description:"Perform 8 Tricks",target:8},3:{description:"Perform 12 Tricks",target:12}},collect_powerups:{1:{description:"Collect 3 Power-ups",target:3},2:{description:"Collect 5 Power-ups",target:5},3:{description:"Collect 7 Power-ups",target:7}}},this.scene=e}}class O extends n.Scene{init(e){this.selectedCharacter=e.selectedCharacter||"kev"}create(){var e,t;let s,i,a,r,o,l,h,c;window.dispatchEvent(new CustomEvent("sceneChanged",{detail:{scene:"Game"}})),this.gameOverTriggered=!1,this.gamePaused=!1,this.physics.resume(),this.time.paused=!1,this.tweens.resumeAll(),this.hasResetChallengeTimer=!1,["pauseBg","pauseTitle","resumeBtn","musicToggle","songsOption","sfxToggle","menuBtn","confirmBg","confirmTitle","confirmText","yesBtn","noBtn","pausedOverlay","pausedText","pauseMenuBg","musicMenuBg","musicTitle","musicBackBtn","songToggle_broken_code","songToggle_undead_empire","songToggle_menu_music","masterMusicToggle"].forEach(e=>{let t=this.children.getByName(e);t&&t.destroy()}),this.health=100,this.stamina=100,this.invulnerable=!1,this.score=0,this.lastObstacleX=0,this.recentObstacles=[],this.lastEnemyX=0,this.lastEnemyY=0,this.lastEnemySpawnTime=0,this.lastSandwichY=0,this.lastSandwichSpawnTime=0,this.lastEnergyDrinkY=0,this.lastEnergyDrinkSpawnTime=0,this.speedMultiplier=1,this.isGrounded=!0,this.jumpCount=0,this.hasDoubleJumped=!1,this.trickActive=!1,this.hasUsedTrick=!1,this.backgroundTiles=[],this.stars=0,this.lives=3,this.nextLifeAt=100,this.sandwichesCollected=0,this.cansCollected=0,this.enemiesDefeated=0,this.metalBootActive=!1,this.fireTacoActive=!1,this.crystalMagnetActive=!1,this.staminaBoostActive=!1,this.activePowerUp=null,this.powerUpCharge=0,this.lastDistanceScoreMilestone=0,this.lastPowerUpSpawnTime=0,this.isStomping=!1,this.waveManager=new _(this),this.challengeManager=new M(this),this.waveManager.setOnWaveChange(e=>{this.onWaveChange(e)}),this.waveManager.setOnSpeedIncrease(e=>{this.speedMultiplier=e}),this.challengeManager.setOnAllChallengesComplete(()=>{this.waveManager.completeChallenge()}),this.challengeManager.generateChallengesForWave(1),this.time.addEvent({delay:1e3,callback:()=>{this.challengeManager.getActiveChallenges().some(e=>!e.completed&&("survive_time"===e.type||"no_damage"===e.type))&&this.updateChallengeDisplay()},callbackScope:this,loop:!0}),this.world=this.createSeamlessWorld(),this.physics.world.gravity.y=this.GRAVITY,this.createPlayer(),this.createParticleEffects(),this.createObstacleSystem(),this.createEnemySystem(),this.createSandwichSystem(),this.createEnergyDrinkSystem(),this.createPowerUpSystem(),this.createStarSystem(),this.cursors=this.input.keyboard.createCursorKeys(),this.controls=(e=this,s=0,i=!1,a=!1,r=!1,o=0,l=0,h=0,c=!1,null===(t=e.input.mouse)||void 0===t||t.disableContextMenu(),e.input.on("pointerdown",t=>{let i=e.time.now;i-s>50&&(o=t.x,l=t.y,h=i,c=!0,console.log("Pointer down at:",o,l))}),e.input.on("pointerup",t=>{if(!c)return;let n=e.time.now,d=t.x-o,p=l-t.y,m=n-h,g=Math.sqrt(d*d+p*p),u=m>0?g/m:0;console.log("Pointer up - deltaY: ".concat(p,", deltaTime: ").concat(m,", distance: ").concat(g,", velocity: ").concat(u)),p>50&&m<300&&u>.3&&Math.abs(d)<p?(a=!0,s=n,console.log("SWIPE UP detected!")):-p>50&&m<300&&u>.3&&Math.abs(d)<Math.abs(p)?(r=!0,s=n,console.log("SWIPE DOWN detected!")):g<20&&(i=!0,s=n,console.log("TAP detected - duration:",m,"ms")),c=!1}),e.input.on("pointerout",()=>{c=!1}),{justTapped:()=>{var t,s;let a=null===(t=e.input.keyboard)||void 0===t?void 0:t.addKey("SPACE"),r=null===(s=e.input.keyboard)||void 0===s?void 0:s.addKey("UP"),o=n.Input.Keyboard.JustDown(a)||n.Input.Keyboard.JustDown(r);return(!!o||!!i)&&(i=!1,console.log("Jump triggered - key:",o,"tap:",!o),!0)},justSwipedUp:()=>!!a&&(a=!1,console.log("Trick triggered by swipe up!"),!0),justSwipedDown:()=>!!r&&(r=!1,console.log("Stomp attack triggered by swipe down!"),!0),holding:()=>!1}),this.trickKey=this.input.keyboard.addKey("J"),this.challengeDisplay&&this.challengeDisplay.destroy(),this.challengeDisplay=void 0,this.challengeWaveText=void 0,this.challengeDescText=void 0,this.challengeProgressText=void 0,this.time.delayedCall(100,()=>{this.updateChallengeDisplay()});let d=this.add.image(80,880,"fingerprint");if(d.setScale(.15),d.setDepth(150),d.setScrollFactor(0),d.setAlpha(1),d.setRotation(.2),this.tweens.add({targets:d,alpha:0,duration:200,ease:"Power0",yoyo:!0,repeat:12}),this.time.delayedCall(5e3,()=>{this.tweens.add({targets:d,alpha:0,duration:500,onComplete:()=>{d.destroy()}})}),this.game.sound.stopAll(),this.game.scene.scenes.forEach(e=>{e.sound&&e.sound.stopAll()}),this.game.sound.getAllPlaying().forEach(e=>{e.stop()}),window.menuMusicInstance){try{window.menuMusicInstance.stop(),window.menuMusicInstance.destroy()}catch(e){}window.menuMusicInstance=void 0,window.menuMusicStarted=!1}this.time.delayedCall(200,()=>{this.currentMusicIndex=.5>Math.random()?0:1,this.playNextBackgroundMusic()}),this.physics.add.overlap(this.player,this.obstacles,(e,t)=>{let s=e.body,i=t.body;if(s.bottom,s.top,s.left,s.right,i.top,i.bottom,i.left,i.right,![].includes(t.texture.key)){if(this.metalBootActive){if(t.getData("flying"))return;t.setData("flying",!0),i.velocity.x=0,i.velocity.x=300,i.velocity.y=-200,i.setGravityY(1200),this.tweens.add({targets:t,angle:720,duration:1500}),this.time.delayedCall(1500,()=>{if(!t||t.destroyed)return;let e=0,s=this.time.addEvent({delay:100,callback:()=>{if(!t||t.destroyed){s.remove();return}t.setVisible(e%2==0),++e>=6&&(t.destroy(),s.remove())},loop:!0})}),this.playSFX("new_explosion_sfx",{volume:.3});return}if(this.fireTacoActive&&!t.getData("onFire")){t.setData("onFire",!0);let e=this.getSpriteCenter(t),s=this.add.image(e.x-5,e.y-5,"fire1");s.setScale(.65),s.setDepth(100);let i=this.add.image(e.x+5,e.y+5,"fire2");i.setScale(.55),i.setDepth(100),t.setData("fireEffects",[s,i]),t.setData("fireOffsets",{x:e.x-t.x,y:e.y-t.y});let a=this.time.addEvent({delay:50,callback:()=>{if(!t||!t.active){a&&a.remove&&a.remove();let e=t.getData("fireEffects");e&&e.forEach(e=>{e&&e.destroy&&e.destroy()});return}let e=t.getData("fireEffects"),s=t.getData("fireOffsets");e&&s&&(e[0]&&e[0].active&&e[0].setPosition(t.x+s.x-5,t.y+s.y-5),e[1]&&e[1].active&&e[1].setPosition(t.x+s.x+5,t.y+s.y+5))},loop:!0});t.setData("fireUpdateTimer",a);return}!t.getData("onFire")&&(this.invulnerable||this.gameOverTriggered||this.staminaBoostActive||(this.takeDamage(25),this.cleanupObstacleFireEffects(t),this.obstacles.remove(t),t.destroy()))}},void 0,this),this.physics.add.overlap(this.player,this.enemies,(e,t)=>{var s,i;let a=e.body;console.log("[DEBUG COLLISION] Enemy collision! Type: ".concat(null===(s=t.texture)||void 0===s?void 0:s.key,", PlayerY: ").concat(e.y,", EnemyY: ").concat(t.y,", VelocityY: ").concat(a.velocity.y));let r=a.velocity.y>0&&e.y<t.y-20;if(this.fireTacoActive){console.log("[DEBUG FIRE TACO] Enemy touched during Fire Taco - checking if stomp or touch"),t&&t.active&&(r?(console.log("[DEBUG FIRE TACO] STOMP during Fire Taco!"),this.stompEnemy(t,!0)):(console.log("[DEBUG FIRE TACO] Touch (not stomp) during Fire Taco!"),this.stompEnemy(t,!1)),this.collectStars(1));return}if(!t.getData("defeated")){if(a.velocity.y>-50&&e.y<t.y-10){console.log("[DEBUG COLLISION] STOMP DETECTED on ".concat(null===(i=t.texture)||void 0===i?void 0:i.key,"!")),this.stompEnemy(t,!0),this.bouncePlayer();return}this.invulnerable||this.gameOverTriggered||this.staminaBoostActive||(this.takeDamage(35),this.enemies.remove(t),t.destroy())}},void 0,this),this.physics.add.overlap(this.player,this.sandwiches,(e,t)=>{this.collectSandwich(t)},void 0,this),this.physics.add.overlap(this.player,this.energyDrinks,(e,t)=>{this.collectEnergyDrink(t)},void 0,this),this.physics.add.overlap(this.player,this.powerUps,(e,t)=>{this.collectPowerUp(t)},void 0,this),this.physics.add.overlap(this.obstacles,this.enemies,(e,t)=>{if(e.getData("flying")){this.stompEnemy(t);let e=this.explosions.create(t.x,t.y,"explosion");e.setScale(.4),e.setDepth(15),this.tweens.add({targets:e,scale:.6,alpha:0,duration:500,onComplete:()=>e.destroy()}),this.comboTracker&&this.comboTracker.registerEnemyKill(this.score,this.isGrounded),this.playSFX("new_explosion_sfx",{volume:.4})}},void 0,this),this.physics.add.overlap(this.fireballs,this.obstacles,(e,t)=>{t.getData("flashTimer")&&t.getData("flashTimer").remove(),this.cleanupObstacleFireEffects(t),t.destroy(),e.destroy();let s=this.explosions.create(t.x,t.y,"explosion");s.setScale(.3),s.setDepth(15),this.tweens.add({targets:s,scale:.5,alpha:0,duration:500,onComplete:()=>s.destroy()}),this.comboTracker&&this.comboTracker.registerTrick(this.score,this.isGrounded),this.playSFX("new_explosion_sfx",{volume:.3})},void 0,this),this.physics.add.overlap(this.fireballs,this.enemies,(e,t)=>{this.stompEnemy(t),e.destroy(),this.comboTracker&&this.comboTracker.registerEnemyKill(this.score,this.isGrounded)},void 0,this),this.physics.add.overlap(this.stompHitbox,this.enemies,(e,t)=>{this.isStomping&&(this.stompEnemy(t),this.comboTracker&&this.comboTracker.registerEnemyKill(this.score,this.isGrounded))},void 0,this),this.physics.add.overlap(this.stompHitbox,this.obstacles,(e,t)=>{if(this.isStomping){this.cleanupObstacleFireEffects(t),t.destroy();let e=this.explosions.create(t.x,t.y,"explosion");e.setScale(.3),e.setDepth(15),this.tweens.add({targets:e,scale:.5,alpha:0,duration:500,onComplete:()=>e.destroy()}),this.comboTracker&&this.comboTracker.registerTrick(this.score,this.isGrounded),this.playSFX("new_explosion_sfx",{volume:.4})}},void 0,this),this.physics.add.overlap(this.fireBreath,this.obstacles,(e,t)=>{if(this.fireBreathActive){this.cleanupObstacleFireEffects(t),t.destroy();let e=this.explosions.create(t.x,t.y,"explosion");e.setScale(.3),e.setDepth(15),this.tweens.add({targets:e,scale:.5,alpha:0,duration:500,onComplete:()=>e.destroy()}),this.comboTracker&&this.comboTracker.registerTrick(this.score,this.isGrounded),this.playSFX("new_explosion_sfx",{volume:.2})}},void 0,this),this.physics.add.overlap(this.fireBreath,this.enemies,(e,t)=>{this.fireBreathActive&&(this.stompEnemy(t),this.comboTracker&&this.comboTracker.registerEnemyKill(this.score,this.isGrounded))},void 0,this),this.cameras.main.setBounds(0,0,Number.MAX_SAFE_INTEGER,960),this.cameras.main.startFollow(this.player,!0,1,1,-100,0),this.escListener=()=>{this.stopBackgroundMusic(),this.cleanupAndStop(),this.scene.start("MainMenu")},this.input.keyboard.on("keydown-ESC",this.escListener),this.gameStartTime=this.time.now,this.trickMessageManager=new P(this),this.comboTracker=new E(this),this.wasGrounded=!0,this.setupComboUI(),this.comboTracker.on("comboActivated",e=>{this.playSFX("combo_sfx",{volume:.5}),this.updateComboUI()}),this.comboTracker.on("comboUpdated",e=>{this.updateComboUI()}),this.comboTracker.on("comboEnded",e=>{this.collectStars(e.starsEarned),this.lastComboData=null});let p=this.add.container(320,480);p.setScrollFactor(0),p.setDepth(110);let m=this.add.graphics();m.fillStyle(0,.8),m.fillRoundedRect(-320,-70,640,180,10),p.add(m);let g=this.add.text(0,-35,"TAP TO JUMP",{fontSize:"22px",fontFamily:'"Press Start 2P", monospace',color:"#00ff00"}).setOrigin(.5),u=this.add.text(0,0,"TAP AGAIN FOR DOUBLE JUMP",{fontSize:"22px",fontFamily:'"Press Start 2P", monospace',color:"#00ffff"}).setOrigin(.5),f=this.add.text(0,35,"SWIPE UP (IN AIR) FOR TRICK",{fontSize:"22px",fontFamily:'"Press Start 2P", monospace',color:"#ffff00"}).setOrigin(.5),y=this.add.text(0,70,"COMBINING TRICKS AND KILLS",{fontSize:"18px",fontFamily:'"Press Start 2P", monospace',color:"#ff00ff"}).setOrigin(.5),x=this.add.text(0,95,"STARTS COMBOS",{fontSize:"18px",fontFamily:'"Press Start 2P", monospace',color:"#ff00ff"}).setOrigin(.5);p.add([g,u,f,y,x]),this.time.delayedCall(5e3,()=>{this.tweens.add({targets:p,alpha:0,duration:1e3,onComplete:()=>{p.destroy()}})}),this.time.addEvent({delay:1e3,callback:()=>{this.player.body},loop:!0})}createSeamlessWorld(){let{createSeamlessWorld:e}=this.loadSeamlessWorld();return e(this)}loadSeamlessWorld(){return{createSeamlessWorld:e=>{this.redSkyBg=e.add.tileSprite(0,0,1920,960,"red_sky_bg").setOrigin(0,0).setScrollFactor(0).setDepth(0).setScale(.5,.5);for(let t=-2;t<=5;t++){let s=e.add.image(320+t*this.backgroundWidth,960,"city_background").setOrigin(.5,1).setScrollFactor(1).setDepth(1).setScale(1.1,1.1);this.backgroundTiles.push(s)}return e.add.graphics().lineStyle(3,16777215,1).lineTo(12e3,0).setPosition(0,850).setScrollFactor(0).setDepth(10),{ground:e.physics.add.staticGroup(),update:e=>{}}}}}createPlayer(){let e="kev"===this.selectedCharacter?"zombie_idle":"stacy_idle";this.player=this.physics.add.sprite(320,850,e),this.player.setCollideWorldBounds(!1),this.player.setDepth(10),this.player.setScale(.4),this.player.clearTint();let t=this.player.body;t.setSize(.8*this.player.width,.9*this.player.height),t.setOffset(.1*this.player.width,.05*this.player.height),t.setMaxVelocity(2400,3600),t.setBounce(0),t.setOffset(0,0),this.player.setTexture(e)}playNextBackgroundMusic(){if(this.currentBgMusic&&(this.currentBgMusic.isPlaying&&this.currentBgMusic.stop(),this.currentBgMusic=null),!this.musicEnabled)return;let e=0,t=this.bgMusicQueue[this.currentMusicIndex];for(;!this.songEnabled[t]&&e<3;)this.currentMusicIndex=(this.currentMusicIndex+1)%3,t=this.bgMusicQueue[this.currentMusicIndex],e++;this.songEnabled[t]&&(this.currentBgMusic=this.sound.add(t,{volume:.4,loop:!1}),this.currentBgMusic.play(),this.showSongTitle(t),this.currentBgMusic.once("complete",()=>{this.currentMusicIndex=(this.currentMusicIndex+1)%3,this.playNextBackgroundMusic()}))}findAndPlayNextEnabledSong(){this.currentMusicIndex=(this.currentMusicIndex+1)%3,this.playNextBackgroundMusic()}playSFX(e,t){this.sfxEnabled&&this.sound.play(e,t)}resumeGame(e){if(this.gamePaused=!1,this.physics.resume(),this.time.paused=!1,this.tweens.resumeAll(),e.setText("PAUSE"),this.musicEnabled){if(this.currentBgMusic){let e=this.bgMusicQueue[this.currentMusicIndex];this.songEnabled[e]?this.currentBgMusic.resume():(this.currentBgMusic.stop(),this.findAndPlayNextEnabledSong())}else this.findAndPlayNextEnabledSong()}else this.currentBgMusic&&this.currentBgMusic.stop();["pausedOverlay","pausedText","pauseMenuBg","resumeBtn","musicToggle","songsOption","sfxToggle","menuBtn","confirmBg","confirmTitle","confirmText","yesBtn","noBtn","musicMenuBg","musicTitle","musicBackBtn","songToggle_broken_code","songToggle_undead_empire","songToggle_menu_music","masterMusicToggle"].forEach(e=>{let t=this.children.getByName(e);t&&t.destroy()})}showMusicSubmenu(){let e=["pauseMenuBg","resumeBtn","musicToggle","songsOption","sfxToggle","menuBtn"];e.forEach(e=>{let t=this.children.getByName(e);t&&"setVisible"in t&&t.setVisible(!1)});let t=this.add.graphics();t.fillStyle(0,.9),t.fillRect(120,360,520,340),t.setDepth(201),t.setScrollFactor(0),t.setName("musicMenuBg");let s=this.add.text(320,400,"MUSIC SETTINGS",{fontSize:"22px",fontFamily:'"Press Start 2P", monospace',color:"#ffff00"});s.setOrigin(.5,.5),s.setDepth(202),s.setScrollFactor(0),s.setName("musicTitle");let i=this.add.text(320,450,"< BACK",{fontSize:"18px",fontFamily:'"Press Start 2P", monospace',color:"#00ff00"});i.setOrigin(.5,.5),i.setDepth(202),i.setScrollFactor(0),i.setInteractive(),i.setName("musicBackBtn");let a=[];[{key:"broken_code",name:"BROKEN CODE",y:510},{key:"undead_empire",name:"UNDEAD EMPIRE",y:560},{key:"menu_music",name:"RISE AGAIN",y:610}].forEach(e=>{let t=this.add.text(320,e.y,"".concat(e.name,": ").concat(this.songEnabled[e.key]?"ON":"OFF"),{fontSize:"16px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff"});t.setOrigin(.5,.5),t.setDepth(202),t.setScrollFactor(0),t.setInteractive(),t.setName("songToggle_".concat(e.key)),a.push(t),t.on("pointerdown",()=>{this.songEnabled[e.key]=!this.songEnabled[e.key],t.setText("".concat(e.name,": ").concat(this.songEnabled[e.key]?"ON":"OFF"))})});let r=this.add.text(320,660,"ALL MUSIC: ".concat(this.musicEnabled?"ON":"OFF"),{fontSize:"16px",fontFamily:'"Press Start 2P", monospace',color:"#ff9900"});r.setOrigin(.5,.5),r.setDepth(202),r.setScrollFactor(0),r.setInteractive(),r.setName("masterMusicToggle"),r.on("pointerdown",()=>{this.musicEnabled=!this.musicEnabled,r.setText("ALL MUSIC: ".concat(this.musicEnabled?"ON":"OFF"))}),i.on("pointerdown",()=>{["musicMenuBg","musicTitle","musicBackBtn","songToggle_broken_code","songToggle_undead_empire","songToggle_menu_music","masterMusicToggle"].forEach(e=>{let t=this.children.getByName(e);t&&t.destroy()}),e.forEach(e=>{let t=this.children.getByName(e);t&&"setVisible"in t&&t.setVisible(!0)})})}showMenuConfirmation(){let e=this.add.graphics();e.fillStyle(0,.95),e.fillRect(70,400,500,200),e.setDepth(203),e.setScrollFactor(0),e.setName("confirmBg");let t=this.add.text(320,440,"ARE YOU SURE?",{fontSize:"24px",fontFamily:'"Press Start 2P", monospace',color:"#ffff00"});t.setOrigin(.5,.5),t.setDepth(204),t.setScrollFactor(0),t.setName("confirmTitle");let s=this.add.text(320,490,"Progress will be lost",{fontSize:"16px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff"});s.setOrigin(.5,.5),s.setDepth(204),s.setScrollFactor(0),s.setName("confirmText");let i=this.add.text(220,550,"YES",{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#ff6666"});i.setOrigin(.5,.5),i.setDepth(204),i.setScrollFactor(0),i.setInteractive(),i.setName("yesBtn");let a=this.add.text(420,550,"NO",{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#00ff00"});a.setOrigin(.5,.5),a.setDepth(204),a.setScrollFactor(0),a.setInteractive(),a.setName("noBtn"),i.on("pointerdown",()=>{this.stopBackgroundMusic(),this.cleanupAndStop(),this.scene.start("MainMenu")}),a.on("pointerdown",()=>{e.destroy(),t.destroy(),s.destroy(),i.destroy(),a.destroy()})}showSongTitle(e){this.songTitleContainer&&this.songTitleContainer.destroy(),this.songTitleContainer=this.add.container(520,350),this.songTitleContainer.setScrollFactor(0),this.songTitleContainer.setDepth(150);let t=this.add.graphics();t.fillStyle(0,.7),t.fillRoundedRect(-130,-35,250,75,5);let s=this.add.text(-10,-10,"broken_code"===e?"BROKEN CODE":"undead_empire"===e?"UNDEAD EMPIRE":"RISE AGAIN",{fontSize:"16px",fontFamily:'"Press Start 2P", monospace',color:"#ffff00"}).setOrigin(.5,.5),i=this.add.text(-10,15,"By Silent Architect",{fontSize:"10px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff"}).setOrigin(.5,.5);this.songTitleContainer.add([t,s,i]),this.songTitleContainer.setAlpha(0),this.tweens.add({targets:this.songTitleContainer,alpha:1,duration:500}),this.time.delayedCall(4e3,()=>{this.songTitleContainer&&this.tweens.add({targets:this.songTitleContainer,alpha:0,duration:1e3,onComplete:()=>{this.songTitleContainer&&(this.songTitleContainer.destroy(),this.songTitleContainer=void 0)}})})}stopBackgroundMusic(){this.currentBgMusic&&(this.currentBgMusic.stop(),this.currentBgMusic=null)}createParticleEffects(){this.dustParticles=this.add.particles(0,0,"pixel",{speed:{min:120,max:360},scale:{start:1.8,end:0},lifespan:300,quantity:3,angle:{min:225,max:315},alpha:{start:.8,end:0},tint:9127187,emitting:!1}),this.jumpParticles=this.add.particles(0,0,"pixel",{speed:{min:180,max:480},scale:{start:2.4,end:0},lifespan:400,quantity:5,angle:{min:0,max:360},alpha:{start:1,end:0},tint:65535,emitting:!1}),this.trickParticles=this.add.particles(0,0,"pixel",{speed:{min:60,max:240},scale:{start:3,end:.6},lifespan:600,quantity:2,angle:{min:0,max:360},alpha:{start:1,end:0},tint:16766720,emitting:!1}),this.dustParticles.setDepth(5),this.jumpParticles.setDepth(15),this.trickParticles.setDepth(15)}createEnemySystem(){this.enemies=this.physics.add.group({allowGravity:!1,immovable:!0}),this.explosions=this.physics.add.group({allowGravity:!1,immovable:!0}),this.arrowIndicators=this.add.group(),this.time.delayedCall(12e3,()=>{this.enemyTimer=this.time.addEvent({delay:3500,callback:this.spawnEnemy,callbackScope:this,loop:!0})}),this.time.addEvent({delay:3e4,callback:()=>{let e=this.time.now-this.gameStartTime,t=this.getDifficulty(e);this.updateEnemySpawnRate(t)},callbackScope:this,loop:!0})}spawnEnemy(){let e;let t=this.time.now-this.gameStartTime;if(this.getDifficulty(t),t<1e4)return;let s=n.Math.Between(600,1e3)+660,i=this.player.x+s;if(i-this.lastEnemyX<400)return;this.lastEnemyX=i;let a=[];if(this.waveManager.isEnemyUnlocked("enemy_robot")&&a.push("enemy_robot"),this.waveManager.isEnemyUnlocked("enemy_eyeball")&&a.push("enemy_eyeball"),this.waveManager.isEnemyUnlocked("enemy_robot2")&&a.push("enemy_robot2"),this.waveManager.isEnemyUnlocked("enemy_robot3")&&a.push("enemy_robot3"),0===a.length)return;let r=n.Utils.Array.GetRandom(a);console.log("[DEBUG ENEMY] Spawning enemy type: ".concat(r," from available: [").concat(a.join(", "),"]"));let o=Math.random();e=o<.5?850-n.Math.Between(120,180):o<.85?850-n.Math.Between(200,260):850-n.Math.Between(320,400);let l=(this.time.now-this.lastSandwichSpawnTime)/1e3,h=(this.time.now-this.lastEnergyDrinkSpawnTime)/1e3;if(l<3&&100>Math.abs(e-this.lastSandwichY)||h<3&&100>Math.abs(e-this.lastEnergyDrinkY))return;this.lastEnemyY=e,this.lastEnemySpawnTime=this.time.now;let c=null;(c=this.arrowIndicators.create(590,e,"arrow_indicator")).setScale(.05),c.setDepth(102),c.setScrollFactor(0),c.x=590,c.y=e;let d=this.tweens.add({targets:c,alpha:{from:1,to:.5},duration:400,yoyo:!0,repeat:-1});c.setScale(.05);let p=this.tweens.add({targets:c,scale:.15,duration:1500,ease:"Power2"});c.flashTween=d,c.growTween=p,this.time.delayedCall(2e3,()=>{if(c){let e=c.flashTween;e&&(e.stop(),e.remove());let t=c.growTween;t&&(t.stop(),t.remove()),c.destroy()}let t=this.player.x+660,s=this.enemies.create(t,e,r);s.setScale(.15),s.setDepth(14),s.setImmovable(!0),s.setPushable(!1),s.setVisible(!0),s.setAlpha(1),this.cameras.main.scrollX,s.arrow=c;let i=s.body;i.setSize(.5*s.width,.5*s.height),i.setVelocityX(-80),this.tweens.add({targets:s,y:e-20,duration:1500,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})})}stompEnemy(e){var t,s;let i=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(console.log("[DEBUG STOMP] stompEnemy called with:",null==e?void 0:null===(t=e.texture)||void 0===t?void 0:t.key,"isStomped:",i),!e||!e.active){console.log("[DEBUG STOMP] stompEnemy called on invalid enemy");return}if(this.gamePaused){console.log("[DEBUG STOMP] Game paused, skipping stomp");return}let a=e.x,r=e.y,o=null===(s=e.texture)||void 0===s?void 0:s.key;this.enemiesDefeated++,this.totalEnemiesStomped++,console.log("[DEBUG STOMP] Updating stomp challenge for enemy:",o);try{this.challengeManager.updateChallenge("stomp_enemies",1),this.updateChallengeDisplay(),console.log("[DEBUG STOMP] Challenge update successful")}catch(e){console.error("[DEBUG STOMP] Error updating challenges:",e)}if(this.comboTracker)try{this.comboTracker.registerEnemyKill(this.score,this.isGrounded);let e=this.comboTracker.getComboState();e.multiplier>this.bestCombo&&(this.bestCombo=e.multiplier)}catch(e){console.error("[DEBUG] Error registering enemy kill with combo:",e)}if(("enemy_robot"===o||"enemy_robot2"===o||"enemy_robot3"===o)&&this.trickMessageManager)try{this.trickMessageManager.addMessage("Robo Kill",1)}catch(e){console.error("[DEBUG] Error adding message:",e)}if("enemy_robot"===o||"enemy_robot2"===o||"enemy_robot3"===o){if(console.log("[DEBUG ROBOT] Robot collision - FireTaco: ".concat(this.fireTacoActive,", isStomped: ").concat(i)),this.fireTacoActive&&!i){if(console.log("[DEBUG ROBOT] Robot exploding from Fire Taco touch!"),this.enemies.contains(e)&&this.enemies.remove(e),e.destroy(),this.explosions){let e=this.explosions.create(a,r,"explosion");e.setScale(.3),e.setDepth(15),this.tweens.add({targets:e,scale:.5,alpha:0,duration:500,onComplete:()=>{this.explosions.contains(e)&&this.explosions.remove(e),e.destroy()}})}this.playSFX("new_explosion_sfx",{volume:.3})}else{console.log("[DEBUG ROBOT] Normal stomp - robot should dip down"),e.setData("defeated",!0),this.enemies.contains(e)&&this.enemies.remove(e),console.log("[DEBUG ROBOT] Creating EXTREME robot squish animation");let t=e.y,s=e.scaleX||1,i=e.scaleY||1;e.setTint(16776960),e.setDepth(20),e.y=t+60,e.setScale(2.5*s,.15*i),e.setAlpha(1),this.tweens.add({targets:e,y:t+10,scaleX:1.8*s,scaleY:.3*i,tint:16711680,duration:150,ease:"Power2",onComplete:()=>{this.tweens.add({targets:e,y:t+35,scaleX:1.4*s,scaleY:.4*i,alpha:.5,tint:8912896,duration:200,ease:"Bounce.out",onComplete:()=>{console.log("[DEBUG ROBOT] EXTREME squish complete!"),e.setDepth(10)}})}}),this.playSFX("new_explosion_sfx",{volume:.15})}}else if("enemy_robot"!==o?(this.enemies.contains(e)&&this.enemies.remove(e),e.destroy()):(console.warn("[DEBUG ROBOT] WARNING: Robot in wrong branch, treating as stomp"),e.setData("defeated",!0),this.enemies.contains(e)&&this.enemies.remove(e),e.setTint(16751001),e.setAlpha(.7)),this.explosions){let e=this.explosions.create(a,r,"explosion");e.setScale(.3),e.setDepth(15),this.tweens.add({targets:e,scale:.5,alpha:0,duration:500,onComplete:()=>{e&&e.active&&e.destroy()}})}this.playSFX("new_explosion_sfx",{volume:.4}),this.score+=50,this.scoreText.setText("Score: "+this.score),this.jumpParticles&&(this.jumpParticles.setPosition(a,r),this.jumpParticles.explode(10))}cleanupObstacleFireEffects(e){let t=e.getData("fireUpdateTimer");t&&(t.remove(),e.setData("fireUpdateTimer",null));let s=e.getData("fireEffects");s&&(s.forEach(e=>{e&&e.destroy&&e.destroy()}),e.setData("fireEffects",null))}bouncePlayer(){let e=this.player.body;e.setVelocityY(this.bounceVelocity);let t=e.velocity.x;e.setVelocityX(Math.min(t+80,450)),this.isGrounded=!1,this.jumpCount=1,this.hasDoubleJumped=!1,this.hasUsedTrick=!1;let s="kev"===this.selectedCharacter?"zombie_jump":"stacy_jump";this.player.setTexture(s),this.player.setScale(this.jumpScale),this.stamina=Math.min(this.maxStamina,this.stamina+35),this.updateStaminaBar(),this.jumpParticles.setPosition(this.player.x,this.player.y),this.jumpParticles.explode(15),this.collectStars(1);let i=this.add.image(this.player.x,this.player.y-50,"star_counter_icon");i.setScale(.15),i.setDepth(16),this.tweens.add({targets:i,y:i.y-100,alpha:0,scale:.15,duration:800,onComplete:()=>i.destroy()})}createObstacleSystem(){var e,t;this.obstacles=this.physics.add.group({allowGravity:!1,immovable:!0}),this.scoreText=this.add.text(50,50,"Score: 0",{fontSize:"24px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:4}),this.scoreText.setDepth(100),this.scoreText.setScrollFactor(0),this.staminaBarBg=this.add.graphics(),this.staminaBarBg.fillStyle(0,.5),this.staminaBarBg.fillRect(50,170,204,24),this.staminaBarBg.setDepth(100),this.staminaBarBg.setScrollFactor(0),this.staminaBar=this.add.graphics(),this.staminaBar.setDepth(101),this.staminaBar.setScrollFactor(0),this.updateStaminaBar(),this.healthBarBg=this.add.graphics(),this.healthBarBg.fillStyle(0,.5),this.healthBarBg.fillRect(50,110,204,24),this.healthBarBg.setDepth(100),this.healthBarBg.setScrollFactor(0),this.healthBar=this.add.graphics(),this.healthBar.setDepth(101),this.healthBar.setScrollFactor(0),this.updateHealthBar(),this.healthText=this.add.text(50,88,"HEALTH",{fontSize:"18px",fontFamily:'"Press Start 2P", monospace',color:"#ff4444",stroke:"#000000",strokeThickness:4}).setDepth(100).setScrollFactor(0),this.add.text(50,148,"STAMINA",{fontSize:"18px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff",stroke:"#000000",strokeThickness:4}).setDepth(100).setScrollFactor(0);let s=this.add.graphics();s.fillStyle(0,.8),s.fillRect(50,200,140,40),s.setDepth(100),s.setScrollFactor(0),s.setInteractive(new n.Geom.Rectangle(50,200,140,40),n.Geom.Rectangle.Contains);let i=this.add.text(120,220,"PAUSE",{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff"});i.setOrigin(.5,.5),i.setDepth(101),i.setScrollFactor(0),i.setInteractive();let a=()=>{if(this.gamePaused||this.gameOverTriggered)this.gamePaused&&this.resumeGame(i);else{this.gamePaused=!0,this.physics.pause(),this.time.paused=!0,this.tweens.pauseAll(),i.setText("RESUME"),this.currentBgMusic&&this.currentBgMusic.pause();let e=this.add.graphics();e.fillStyle(0,.7),e.fillRect(0,0,640,960),e.setDepth(200),e.setScrollFactor(0),e.setName("pausedOverlay");let t=this.add.text(320,320,"PAUSED",{fontSize:"48px",fontFamily:'"Press Start 2P", monospace',color:"#ffff00",stroke:"#000000",strokeThickness:8});t.setOrigin(.5,.5),t.setDepth(201),t.setScrollFactor(0),t.setName("pausedText");let s=this.add.graphics();s.fillStyle(0,.9),s.fillRect(120,380,400,300),s.setDepth(201),s.setScrollFactor(0),s.setName("pauseMenuBg");let a=this.add.text(320,420,"RESUME",{fontSize:"24px",fontFamily:'"Press Start 2P", monospace',color:"#00ff00"});a.setOrigin(.5,.5),a.setDepth(202),a.setScrollFactor(0),a.setInteractive(),a.setName("resumeBtn");let r=this.add.text(320,470,"MUSIC: ".concat(this.musicEnabled?"ON":"OFF"),{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff"});r.setOrigin(.5,.5),r.setDepth(202),r.setScrollFactor(0),r.setInteractive(),r.setName("musicToggle");let o=this.add.text(320,520,"SFX: ".concat(this.sfxEnabled?"ON":"OFF"),{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff"});o.setOrigin(.5,.5),o.setDepth(202),o.setScrollFactor(0),o.setInteractive(),o.setName("sfxToggle");let n=this.add.text(320,570,"SONG LIST",{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#ffffff"});n.setOrigin(.5,.5),n.setDepth(202),n.setScrollFactor(0),n.setInteractive(),n.setName("songsOption");let l=this.add.text(320,620,"BACK TO MENU",{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#ff6666"});l.setOrigin(.5,.5),l.setDepth(202),l.setScrollFactor(0),l.setInteractive(),l.setName("menuBtn"),a.on("pointerdown",()=>{this.resumeGame(i)}),r.on("pointerdown",()=>{this.musicEnabled=!this.musicEnabled,r.setText("MUSIC: ".concat(this.musicEnabled?"ON":"OFF")),!this.musicEnabled&&this.currentBgMusic&&this.currentBgMusic.stop()}),n.on("pointerdown",()=>{this.showMusicSubmenu()}),o.on("pointerdown",()=>{this.sfxEnabled=!this.sfxEnabled,o.setText("SFX: ".concat(this.sfxEnabled?"ON":"OFF")),this.sfxEnabled&&this.playSFX("jump_sfx",{volume:.2})}),l.on("pointerdown",()=>{this.showMenuConfirmation()})}};i.on("pointerdown",a),s.on("pointerdown",a),this.pauseListener=a,null===(e=this.input.keyboard)||void 0===e||e.on("keydown-P",this.pauseListener),null===(t=this.input.keyboard)||void 0===t||t.on("keydown-KeyP",this.pauseListener),this.createLifeDisplay(),this.starIcon=this.add.image(500,145,"star_counter_icon"),this.starIcon.setScale(.08),this.starIcon.setDepth(100),this.starIcon.setScrollFactor(0),this.starText=this.add.text(540,145,"0",{fontSize:"22px",fontFamily:'"Press Start 2P", monospace',color:"#ffff00",stroke:"#000000",strokeThickness:4}),this.starText.setDepth(100),this.starText.setScrollFactor(0),this.starText.setOrigin(0,.5),this.obstacleTimer=this.time.addEvent({delay:3500,callback:()=>{this.hasResetChallengeTimer||(this.challengeManager.resetStartTime(),this.hasResetChallengeTimer=!0),this.spawnObstacle()},callbackScope:this,loop:!0})}spawnObstacle(){let e=this.time.now-this.gameStartTime,t=this.getDifficulty(e),s=Math.max(400-25*t,150)+660,i=Math.max(800-50*t,300)+660,a=n.Math.Between(s,i),r=this.player.x+a;if(r-this.lastObstacleX<s)return;this.lastObstacleX=r;let o=this.chooseObstacleType(t),l=this.arrowIndicators.create(590,906,"arrow_indicator");l.setScale(.05),l.setDepth(102),l.setScrollFactor(0),l.x=590,l.y=906;let h=this.tweens.add({targets:l,alpha:{from:1,to:.5},duration:400,yoyo:!0,repeat:-1});l.setScale(.05);let c=this.tweens.add({targets:l,scale:.15,duration:1500,ease:"Power2"});l.flashTween=h,l.growTween=c,this.time.delayedCall(2e3,()=>{let e=l.flashTween;e&&(e.stop(),e.remove());let s=l.growTween;s&&(s.stop(),s.remove()),l.destroy();let i=this.player.x+700;t>3&&.3>Math.random()?this.spawnObstaclePattern(i,o):this.createSingleObstacle(i,o)}),this.updateSpawnRate(t)}getDifficulty(e){return Math.min(Math.floor(e/3e4),10)}chooseObstacleType(e){let t;let s=this.obstacleTypes.filter(e=>this.waveManager.isObstacleUnlocked(e));if(0===s.length)return"obstacle_trash";let i=[...s];if(this.recentObstacles.length>=2&&this.recentObstacles[0]===this.recentObstacles[1]){let e=this.recentObstacles[0];0===(i=i.filter(t=>t!==e)).length&&(i=[...s])}if(this.waveManager.getCurrentWave()>=2&&.3>Math.random()){let e=i.filter(e=>e.includes("cone")||e.includes("skulls"));t=e.length>0?n.Utils.Array.GetRandom(e):n.Utils.Array.GetRandom(i)}else t=n.Utils.Array.GetRandom(i);return this.recentObstacles.unshift(t),this.recentObstacles.length>2&&this.recentObstacles.pop(),t}createSingleObstacle(e,t){if(!this.textures.exists(t)){console.error("Texture ".concat(t," does not exist!"));return}let s=this.obstacles.create(e,956,t),i="obstacle_zombie"===t?.17:.15;s.setScale(i),s.setDepth(8),s.setOrigin(.5,1),s.setImmovable(!0),s.setPushable(!1);let a=s.body;a.setSize(.8*s.width,s.height+110),a.setOffset(.1*s.width,-110)}spawnObstaclePattern(e,t){switch(n.Math.Between(1,3)){case 1:this.createSingleObstacle(e,t),this.createSingleObstacle(e+200,t);break;case 2:this.createSingleObstacle(e,t),this.createSingleObstacle(e+150,t),this.createSingleObstacle(e+300,t);break;case 3:this.createSingleObstacle(e,t);let s=n.Utils.Array.GetRandom(this.obstacleTypes);this.createSingleObstacle(e+250,s)}}updateSpawnRate(e){if(e===this.lastDifficulty)return;this.lastDifficulty=e,this.obstacleTimer&&this.obstacleTimer.remove();let t=this.waveManager.getCurrentWave(),s=4500;2===t?s=3800:3===t&&(s=3200);let i=Math.max(s-150*e,2e3);this.obstacleTimer=this.time.addEvent({delay:i,callback:this.spawnObstacle,callbackScope:this,loop:!0})}updateEnemySpawnRate(e){this.enemyTimer&&this.enemyTimer.remove();let t=this.waveManager.getCurrentWave(),s=5e3;2===t?s=4200:3===t&&(s=3500);let i=Math.max(s-200*e,2200);this.enemyTimer=this.time.addEvent({delay:i,callback:this.spawnEnemy,callbackScope:this,loop:!0})}gameOver(){let e=this.time.now-this.gameStartTime;this.lives>0?(this.lives--,this.updateLifeDisplay(),this.respawnPlayer()):(this.stopBackgroundMusic(),this.fireTacoActive&&this.endFireTacoEffect(),this.obstacleTimer&&this.obstacleTimer.remove(),this.sandwichTimer&&this.sandwichTimer.remove(),this.enemyTimer&&this.enemyTimer.remove(),this.scene.start("GameOver",{score:this.score,time:e,sandwiches:this.sandwichesCollected,cans:this.cansCollected,stars:this.stars,enemies:this.enemiesDefeated}))}handleLanding(){this.isGrounded=!0,this.hasDoubleJumped=!1,this.trickActive=!1,this.hasUsedTrick=!1,this.jumpCount=0,!this.isStomping||(this.isStomping=!1,this.stompHitbox&&this.stompHitbox.body&&(this.stompHitbox.body.enable=!1),this.jumpParticles.setPosition(this.player.x,850),this.jumpParticles.explode(30),this.invulnerable||this.metalBootActive||this.fireTacoActive||this.crystalMagnetActive||this.staminaBoostActive||this.player.clearTint()),this.physics.world.gravity.y=this.GRAVITY;let e="kev"===this.selectedCharacter?"zombie_idle":"stacy_idle";this.player.setTexture(e),this.player.setScale(.4),this.player.setVelocityY(0),this.player.y=850}performJump(){if((this.isGrounded||0===this.jumpCount)&&this.stamina>=this.staminaCost&&!this.hasDoubleJumped){this.player.setVelocityY(this.JUMP_VELOCITY),this.playSFX("jump_sfx",{volume:.3}),this.player.stop();let e="kev"===this.selectedCharacter?"zombie_jump":"stacy_jump";this.player.setTexture(e),this.player.setScale(this.jumpScale),this.isGrounded=!1,this.jumpCount=1,this.hasDoubleJumped=!1,this.staminaBoostActive||(this.stamina=Math.max(0,this.stamina-this.staminaCost)),this.updateStaminaBar(),this.dustParticles.setPosition(this.player.x,this.player.y+48),this.dustParticles.explode(3),this.jumpParticles.setPosition(this.player.x,this.player.y),this.jumpParticles.explode(5)}else if(1===this.jumpCount&&!this.hasDoubleJumped&&this.stamina>=this.staminaCost){this.player.setVelocityY(this.TRICK_JUMP_VELOCITY),this.player.stop();let e="kev"===this.selectedCharacter?"zombie_jump":"stacy_jump";this.player.setTexture(e),this.player.setScale(this.jumpScale),this.hasDoubleJumped=!0,this.trickActive=!1,this.jumpCount=2,this.staminaBoostActive||(this.stamina=Math.max(0,this.stamina-this.staminaCost)),this.updateStaminaBar(),this.trickParticles.setPosition(this.player.x,this.player.y),this.trickParticles.start(),this.physics.world.gravity.y=this.FLOAT_GRAVITY,this.time.delayedCall(600,()=>{this.physics.world.gravity.y=this.GRAVITY,this.trickActive=!1,this.trickParticles.stop()})}else this.stamina,this.staminaCost}performTrick(){if(this.isGrounded||this.hasUsedTrick||!(this.stamina>=15))this.isGrounded||this.hasUsedTrick||this.stamina;else{this.player.setVelocityY(this.SWIPE_TRICK_VELOCITY),this.player.stop();let e="kev"===this.selectedCharacter?"zombie_trick":"stacy_trick";if(this.player.setTexture(e),this.player.setScale(this.jumpScale),this.trickActive=!0,this.checkSpecialTrickMove(),this.comboTracker){this.comboTracker.registerTrick(this.score,this.isGrounded);let e=this.comboTracker.getComboState();e.multiplier>this.bestCombo&&(this.bestCombo=e.multiplier)}console.log("[DEBUG TRICK] About to update perform_tricks challenge"),this.challengeManager.updateChallenge("perform_tricks",1),console.log("[DEBUG TRICK] perform_tricks challenge updated"),this.hasUsedTrick=!0,this.staminaBoostActive||(this.stamina=Math.max(0,this.stamina-15)),this.updateStaminaBar(),this.score+=10,this.scoreText.setText("Score: "+this.score),this.trickParticles.setPosition(this.player.x,this.player.y),this.trickParticles.start(),this.physics.world.gravity.y=this.FLOAT_GRAVITY,this.time.delayedCall(400,()=>{if(this.physics.world.gravity.y=this.GRAVITY,this.trickActive=!1,this.trickParticles.stop(),!this.isGrounded){let e="kev"===this.selectedCharacter?"zombie_jump":"stacy_jump";this.player.setTexture(e),this.player.setScale(this.jumpScale)}})}}checkSpecialTrickMove(){let e=[],t=[],s=0;if(this.obstacles.children.entries.forEach(i=>{let a=i.x-this.player.x;if(this.player.y<i.y&&a>=-250&&a<=300){let a="";"obstacle_trash"===i.texture.key?a="Trash Nose Grab":"obstacle_cone"===i.texture.key?a="Caution!":"obstacle_skulls"===i.texture.key?a="Bonehead Move!":("obstacle_crash"===i.texture.key||"obstacle_zombie"===i.texture.key)&&(a="Trash Nose Grab"),a&&(e.push(i),t.push(a),s+=1)}}),this.enemies.children.entries.forEach(i=>{let a=i.x-this.player.x;this.player.y<i.y&&a>=-250&&a<=300&&(e.push(i),t.push("Robo Nose Grab"),s+=1)}),e.length>0){let e;e=t.every(e=>e===t[0])?1===t.length?t[0]:"".concat(t[0]," x").concat(t.length):2===t.length?"Double Tap":3===t.length?"OH BOY A TRIPLE!":"Mega Combo x".concat(t.length),this.showSpecialMove(e,s)}}showSpecialMove(e,t){this.collectStars(t),this.playSFX("new_star_sfx",{volume:.4}),this.comboTracker&&this.comboTracker.registerTrick(this.score,!1),this.trickMessageManager.addMessage(e,t)}updateStaminaBar(){this.staminaBar.clear();let e=65280;if(!this.staminaBoostActive&&(this.stamina<=30&&this.time.now-this.lastStaminaWarnPlayed>2e3&&(this.playStaminaWarningSound(),this.lastStaminaWarnPlayed=this.time.now),this.stamina>=this.maxStamina&&this.time.now-this.lastStaminaFullPlayed>5e3&&(this.playStaminaFullSound(),this.lastStaminaFullPlayed=this.time.now)),this.staminaBoostActive){this.stamina=this.maxStamina;let t=Math.floor(this.time.now/200)%3;e=0===t?16777215:1===t?65535:16711935}else this.stamina<33.33?e=16711680:this.stamina<66.66&&(e=16755200);this.staminaBar.fillStyle(e,1);let t=this.stamina/this.maxStamina*200;this.staminaBar.fillRect(52,172,t,20)}playStaminaWarningSound(){this.playSFX("jump_sfx",{volume:.3,rate:.7})}playStaminaFullSound(){this.playSFX("new_star_sfx",{volume:.2,rate:1.5})}updatePowerUpTints(){if(this.invulnerable)return;let e=this.time.now,t=[];if(this.metalBootActive&&t.push("metal"),this.fireTacoActive&&t.push("fire"),this.crystalMagnetActive&&t.push("crystal"),this.staminaBoostActive&&t.push("stamina"),0===t.length){this.player.clearTint();return}let s=Math.floor(e/150)%t.length,i=Math.floor(e/300)%2,a=16777215;switch(t[s]){case"metal":a=0===i?6316128:16777215;break;case"fire":a=0===i?16711680:16737792;break;case"crystal":a=0===i?16776960:16768256;break;case"stamina":let r=Math.floor(e/150)%3;a=0===r?16777215:1===r?65535:16711935}this.player.setTint(a)}updateHealthBar(){this.healthBar.clear();let e=65280;if(this.fireTacoActive)e=0==Math.floor(this.time.now/200)%2?16711680:16753920;else if(this.staminaBoostActive){let t=Math.floor(this.time.now/200)%3;e=0===t?16777215:1===t?65535:16711935}else this.health<30?e=16711680:this.health<60&&(e=16755200);this.healthBar.fillStyle(e,1);let t=this.health/this.maxHealth;this.healthBar.fillRect(52,112,200*t,20)}takeDamage(e){if(this.invulnerable)return;this.challengeManager.resetNoDamageChallenge();let t=Math.max(0,this.health-e);this.health=t,this.updateHealthBar(),this.player.setTint(16711680),this.invulnerable=!0,this.player.setDepth(15);let s=0,i=this.time.addEvent({delay:150,callback:()=>{++s%2==0?this.player.setTint(16777215):this.player.setTint(16746632),s>=8&&(this.player.clearTint(),this.invulnerable=!1,this.player.setDepth(10),i.remove())},loop:!0});this.health<=0&&(this.gameOverTriggered=!0,this.gameOver())}createSandwichSystem(){this.sandwiches=this.physics.add.group({allowGravity:!1,immovable:!0}),this.sandwichTimer=this.time.addEvent({delay:2e4,callback:this.spawnSandwich,callbackScope:this,loop:!0}),this.time.delayedCall(15e3,()=>{this.spawnSandwich()})}spawnSandwich(){let e=n.Math.Between(800,1200),t=n.Math.Between(400,600),s=(this.time.now-this.lastEnemySpawnTime)/1e3,i=(this.time.now-this.lastEnergyDrinkSpawnTime)/1e3;if(s<3&&100>Math.abs(t-this.lastEnemyY)||i<3&&100>Math.abs(t-this.lastEnergyDrinkY))return;this.lastSandwichY=t,this.lastSandwichSpawnTime=this.time.now;let a=this.arrowIndicators.create(580,t,"sandwich_arrow");a.setScale(.05),a.setDepth(102),a.setScrollFactor(0);let r=this.tweens.add({targets:a,alpha:{from:1,to:.5},duration:400,yoyo:!0,repeat:-1}),o=this.tweens.add({targets:a,scale:{from:.05,to:.15},duration:1500,ease:"Power2"});a.flashTween=r,a.growTween=o,this.time.delayedCall(2e3,()=>{let s=a.flashTween;s&&(s.stop(),s.remove());let i=a.growTween;i&&(i.stop(),i.remove()),a.destroy();let r=this.player.x+e,o=this.sandwiches.create(r,t,"sandwich");o.setScale(.12),o.setDepth(10),this.tweens.add({targets:o,y:t-20,duration:1500,ease:"Sine.inOut",yoyo:!0,repeat:-1})})}createEnergyDrinkSystem(){this.energyDrinks=this.physics.add.group({allowGravity:!1,immovable:!0}),this.energyDrinkTimer=this.time.addEvent({delay:5e3,callback:()=>{(this.time.now-this.lastEnergyDrinkSpawnTime)/1e3>=30&&.3>Math.random()&&this.spawnEnergyDrink()},callbackScope:this,loop:!0}),this.time.delayedCall(n.Math.Between(35e3,45e3),()=>{this.spawnEnergyDrink()})}spawnEnergyDrink(){if((this.time.now-this.lastEnergyDrinkSpawnTime)/1e3<30)return;n.Math.Between(900,1300);let e=n.Math.Between(450,650),t=(this.time.now-this.lastSandwichSpawnTime)/1e3,s=(this.time.now-this.lastEnemySpawnTime)/1e3;if(t<3&&100>Math.abs(e-this.lastSandwichY)||s<3&&100>Math.abs(e-this.lastEnemyY))return;this.lastEnergyDrinkY=e,this.lastEnergyDrinkSpawnTime=this.time.now;let i=this.arrowIndicators.create(580,e,"energy_warning");i.setScale(.15),i.setDepth(102),i.setScrollFactor(0);let a=this.tweens.add({targets:i,alpha:{from:1,to:.5},duration:400,yoyo:!0,repeat:-1});i.flashTween=a,this.time.delayedCall(2e3,()=>{let t=i.flashTween;t&&(t.stop(),t.remove());let s=i.growTween;s&&(s.stop(),s.remove()),i.destroy();let a=this.player.x+700,r=this.energyDrinks.create(a,e,"energy_drink");r.setScale(.12),r.setDepth(10),this.tweens.add({targets:r,y:e-20,duration:1500,ease:"Sine.inOut",yoyo:!0,repeat:-1}),this.tweens.add({targets:r,alpha:{from:.8,to:1},duration:300,yoyo:!0,repeat:-1})})}collectEnergyDrink(e){this.playSFX("energy_drink_sfx",{volume:.5}),this.cansCollected++,this.displayPowerUpText("maximum_text"),this.staminaBoostActive=!0,this.stamina=this.maxStamina,this.staminaBoostTimer&&this.staminaBoostTimer.remove(),this.staminaBoostTimer=this.time.delayedCall(1e4,()=>{this.staminaBoostActive=!1,this.invulnerable||this.player.clearTint()}),this.score+=50,this.scoreText.setText("Score: "+this.score),this.comboTracker&&this.comboTracker.registerTrick(this.score,this.isGrounded),this.jumpParticles.setPosition(e.x,e.y),this.jumpParticles.explode(25),e.destroy()}createPowerUpSystem(){this.powerUps=this.physics.add.group({allowGravity:!1,immovable:!0}),this.fireballs=this.physics.add.group({allowGravity:!1}),this.stompHitbox=this.add.rectangle(0,0,80,100,16711680,0),this.physics.add.existing(this.stompHitbox),this.stompHitbox.setVisible(!1),this.stompHitbox.body.enable=!1,this.fireBreath=this.add.sprite(0,0,"fire_breath"),this.physics.add.existing(this.fireBreath),this.fireBreath.setVisible(!1),this.fireBreath.setScale(.3),this.fireBreath.setDepth(15),this.fireBreath.body.enable=!1,this.powerUpTimer=this.time.addEvent({delay:5e3,callback:()=>{(this.time.now-this.lastPowerUpSpawnTime)/1e3>=20&&.5>Math.random()&&this.spawnPowerUp()},callbackScope:this,loop:!0}),this.time.delayedCall(n.Math.Between(15e3,2e4),()=>{this.spawnPowerUp()})}spawnPowerUp(){if((this.time.now-this.lastPowerUpSpawnTime)/1e3<45||n.Math.FloatBetween(0,1)>.5)return;this.lastPowerUpSpawnTime=this.time.now;let e=[];if(this.waveManager.isPowerUpUnlocked("metal_skateboard")&&e.push("metal_skateboard"),this.waveManager.isPowerUpUnlocked("fire_taco")&&e.push("fire_taco"),this.waveManager.isPowerUpUnlocked("crystal_magnet")&&e.push("crystal_magnet"),0===e.length)return;let t=n.Utils.Array.GetRandom(e),s="fire_taco"===t||"crystal_magnet"===t||"metal_skateboard"===t?"warning_triangle":"arrow_indicator",i=this.arrowIndicators.create(580,480,s);i.setScale(.05),i.setDepth(102),i.setScrollFactor(0),"arrow_indicator"===s&&("metal_skateboard"===t?i.setTint(16777215):"fire_taco"===t?i.setTint(16755200):"crystal_magnet"===t&&i.setTint(65535)),this.tweens.add({targets:i,scaleX:.15,scaleY:.15,duration:2e3,ease:"Power2"});let a=this.tweens.add({targets:i,alpha:{from:1,to:.5},duration:400,yoyo:!0,repeat:-1});i.flashTween=a,this.time.delayedCall(2e3,()=>{let e=i.flashTween;e&&(e.stop(),e.remove());let s=i.growTween;s&&(s.stop(),s.remove()),i.destroy();let a=this.player.x+700,r=this.powerUps.create(a,480,t);r.powerUpType=t;let o="metal_skateboard"===t?.2:.12;r.setScale(o),r.setDepth(10),this.tweens.add({targets:r,y:472,duration:1800,ease:"Sine.inOut",yoyo:!0,repeat:-1}),"crystal_magnet"===t&&this.tweens.add({targets:r,rotation:2*Math.PI,duration:4e3,ease:"Linear",repeat:-1})})}collectPowerUp(e){let t=e.powerUpType;this.challengeManager.updateChallenge("collect_powerups",1),this.updateChallengeDisplay(),"metal_skateboard"===t?this.collectMetalBoot():"fire_taco"===t?this.collectFireTaco():"crystal_magnet"===t&&this.collectCrystalMagnet(),this.playSFX("star_cluster_sfx",{volume:.4}),this.jumpParticles.setPosition(e.x,e.y),this.jumpParticles.explode(30),e.destroy()}displayPowerUpText(e){let t=this.add.container(320,540);t.setDepth(150),t.setScrollFactor(0);let s=this.add.image(0,0,e),i=0===this.activePowerUpTexts.length,a=1;a=i?"stay_lit_text"===e?.4:"heavy_metal_ride_text"===e?.54:"my_lead_foot_text"===e||"get_over_here_text"===e?.45:.48:"stay_lit_text"===e?.26:"heavy_metal_ride_text"===e?.36:"my_lead_foot_text"===e||"get_over_here_text"===e?.3:.32,s.setScale(0),t.add(s),this.tweens.add({targets:s,scaleX:a,scaleY:a,duration:300,ease:"Back.easeOut"});let r={container:t,text:s,cross:null,imageKey:e};"maximum_text"===e?this.activePowerUpTexts.unshift(r):this.activePowerUpTexts.push(r),this.reflowPowerUpTexts(),this.time.delayedCall(1500,()=>{this.tweens.add({targets:t,x:-400,duration:100,ease:"Power3.easeIn",onComplete:()=>{r.cross&&(r.cross.destroy(),r.cross=null);let e=this.activePowerUpTexts.indexOf(r);e>-1&&this.activePowerUpTexts.splice(e,1),t.destroy(!0),this.reflowPowerUpTexts()}})})}reflowPowerUpTexts(){if(this.activePowerUpTexts.forEach(e=>{e.cross&&(e.cross.destroy(),e.cross=null)}),0===this.activePowerUpTexts.length)return;let e=1===this.activePowerUpTexts.length;this.activePowerUpTexts.forEach(t=>{let s=t.imageKey,i=1;i=e?"stay_lit_text"===s?.4:"heavy_metal_ride_text"===s?.54:"my_lead_foot_text"===s||"get_over_here_text"===s?.45:.48:"stay_lit_text"===s?.26:"heavy_metal_ride_text"===s?.36:"my_lead_foot_text"===s||"get_over_here_text"===s?.3:.32,this.tweens.add({targets:t.text,scaleX:i,scaleY:i,duration:200,ease:"Power2.easeOut"})});let t={1:[500],2:[360,520],3:[290,380,470]}[Math.min(this.activePowerUpTexts.length,3)];if(this.activePowerUpTexts.forEach((e,s)=>{if(s>=t.length)return;let i=t[s];this.tweens.add({targets:e.container,y:i,duration:200,ease:"Power2.easeOut"})}),2===this.activePowerUpTexts.length){let e=this.add.image(320,425,"powerup_cross");e.setScale(.05),e.setDepth(151),e.setScrollFactor(0),this.activePowerUpTexts[0].cross=e}}collectMetalBoot(){this.metalBootActive=!0,this.totalPowerUpsUsed++,this.player.setDepth(15),this.comboTracker&&this.comboTracker.registerTrick(this.score,this.isGrounded),this.player.setTint(10337740);let e=0,t=this.time.addEvent({delay:150,callback:()=>{++e%2==0?this.player.setTint(10337740):this.player.setTint(8235449),e>=8&&(this.player.setTint(8235449),t.remove())},repeat:7});this.displayPowerUpText("heavy_metal_ride_text")}collectFireTaco(){if(this.fireTacoActive=!0,this.totalPowerUpsUsed++,this.comboTracker)try{this.comboTracker.registerTrick(this.score,this.isGrounded)}catch(e){console.error("[FIRE TACO] Error registering combo:",e)}this.displayPowerUpText("stay_lit_text");let e=this.add.image(this.player.x,this.player.y-50,"exclamation_mark");e.setScale(.08),e.setDepth(200);let t=this.tweens.add({targets:e,alpha:{from:1,to:.5},duration:400,yoyo:!0,repeat:-1}),s=this.time.addEvent({delay:16,callback:()=>{e&&e.active&&(e.x=this.player.x,e.y=this.player.y-40)},repeat:125});this.time.delayedCall(2e3,()=>{s.remove(),t.stop(),e.destroy()}),this.time.delayedCall(2e3,()=>{for(let e=0;e<5;e++)this.time.delayedCall(250*e,()=>{this.gameOver||this.gameOverTriggered||this.gamePaused||this.spawnEnemy()});this.createFireSprites(),this.startFireColorFlash()}),this.time.delayedCall(19e3,()=>{this.playSFX("jump_sfx",{volume:.4}),this.fireColorTimer&&(this.fireColorTimer.remove(),this.fireColorTimer=void 0);let e=0;this.time.addEvent({delay:150,callback:()=>{e%2==0?this.player.clearTint():this.player.setTint([16729344,16747520][e%2]),e++},repeat:19})}),this.time.delayedCall(22e3,()=>{this.endFireTacoEffect()})}createFireSprites(){this.fireShoulder=this.add.image(this.player.x+5,this.player.y-55,"fire1"),this.fireShoulder.setScale(.45),this.fireShoulder.setDepth(11),this.fireBody=this.add.image(this.player.x+10,this.player.y-10,"fire2"),this.fireBody.setScale(.5),this.fireBody.setDepth(11),this.fireRight=this.add.image(this.player.x+60,this.player.y-50,"fire1"),this.fireRight.setScale(.4),this.fireRight.setDepth(11),this.fireSprites=[this.fireShoulder,this.fireBody,this.fireRight],this.floorFireTrails=[],this.fireTrailTimer=this.time.addEvent({delay:3e3,callback:()=>{var e;if(!this.fireTacoActive||!this.isGrounded)return;let t=this.add.image(this.player.x-60,this.player.y+35,"fire1");t.setScale(.7),t.setDepth(7),this.tweens.add({targets:t,alpha:{from:1,to:0},duration:4e3,onComplete:()=>{var e,s;t.destroy();let i=null===(e=this.floorFireTrails)||void 0===e?void 0:e.indexOf(t);void 0!==i&&i>-1&&(null===(s=this.floorFireTrails)||void 0===s||s.splice(i,1))}}),null===(e=this.floorFireTrails)||void 0===e||e.push(t)},loop:!0})}startFireColorFlash(){this.fireColorTimer=this.time.addEvent({delay:200,callback:()=>{if(!this.fireTacoActive)return;let e=[16729344,16753920,16737792],t=e[Math.floor(Math.random()*e.length)];this.player.setTint(t)},loop:!0})}getSpriteCenter(e){return{x:e.x+e.displayWidth*(.5-e.originX),y:e.y+e.displayHeight*(.5-e.originY)}}generatePlayerFireOffsets(){let e=[];return[{name:"shoulder",minY:-45,maxY:-30},{name:"torso",minY:-25,maxY:-10},{name:"hips",minY:-5,maxY:10},{name:"legs",minY:15,maxY:30},{name:"trail",minY:-15,maxY:15}].forEach((t,s)=>{let i=t.minY+Math.random()*(t.maxY-t.minY),a=(Math.random()-.5)*25;"trail"===t.name?e.push({x:-40+.3*a,y:i}):e.push({x:a,y:i})}),e}updateFireSprites(){if(this.fireTacoActive&&this.fireSprites){if(this.fireShoulder){let e=this.player.x+5,t=this.player.y-55;this.fireShoulder.x+=(e-this.fireShoulder.x)*.8,this.fireShoulder.y+=(t-this.fireShoulder.y)*.8}if(this.fireBody){let e=this.player.x+10,t=this.player.y-10;this.fireBody.x+=(e-this.fireBody.x)*.8,this.fireBody.y+=(t-this.fireBody.y)*.8}if(this.fireRight){let e=this.player.x+60,t=this.player.y-50;this.fireRight.x+=(e-this.fireRight.x)*.8,this.fireRight.y+=(t-this.fireRight.y)*.8}}}endFireTacoEffect(){this.fireTacoActive=!1,this.fireSprites&&(this.fireSprites.forEach(e=>null==e?void 0:e.destroy()),this.fireSprites=[]),this.floorFireTrails&&(this.floorFireTrails.forEach(e=>null==e?void 0:e.destroy()),this.floorFireTrails=[]),this.fireTrailTimer&&(this.fireTrailTimer.remove(),this.fireTrailTimer=void 0),this.fireShoulder=void 0,this.fireBody=void 0,this.fireRight=void 0,this.fireColorTimer&&(this.fireColorTimer.remove(),this.fireColorTimer=void 0),this.player.clearTint()}collectCrystalMagnet(){this.displayPowerUpText("get_over_here_text"),this.comboTracker&&this.comboTracker.registerTrick(this.score,this.isGrounded),this.crystalMagnetActive=!0,this.totalPowerUpsUsed++,this.time.delayedCall(2e4,()=>{this.crystalMagnetActive=!1});let e=0,t=this.time.addEvent({delay:1e3,callback:()=>{e++;let s=this.player.x+400+200*e,i=this.player.y-50;for(let e=0;e<5;e++){let t=this.starPickups.create(s+60*e,i+n.Math.Between(-20,20),"star_counter_icon");t.setScale(.036),t.setDepth(10),t.value=1}e>=20&&t.remove()},loop:!0})}showPowerUpBar(){this.powerUpBarBg||(this.powerUpBarBg=this.add.graphics(),this.powerUpBarBg.fillStyle(0,.5),this.powerUpBarBg.fillRect(50,230,204,24),this.powerUpBarBg.setDepth(100),this.powerUpBarBg.setScrollFactor(0),this.powerUpBar=this.add.graphics(),this.powerUpBar.setDepth(101),this.powerUpBar.setScrollFactor(0),this.powerUpText=this.add.text(50,208,"POWER-UP",{fontSize:"18px",fontFamily:'"Press Start 2P", monospace',color:"#ffaa00",stroke:"#000000",strokeThickness:4}),this.powerUpText.setDepth(100),this.powerUpText.setScrollFactor(0)),this.powerUpBarBg.setVisible(!0),this.powerUpBar.setVisible(!0),this.powerUpText.setVisible(!0),this.updatePowerUpBar()}hidePowerUpBar(){this.powerUpBarBg&&(this.powerUpBarBg.setVisible(!1),this.powerUpBar.setVisible(!1),this.powerUpText.setVisible(!1))}updatePowerUpBar(){if(!this.powerUpBar||!this.powerUpBar.visible)return;this.powerUpBar.clear();let e="metal_boot"===this.activePowerUp?8947848:16737792;this.powerUpBar.fillStyle(e);let t=this.powerUpCharge/this.maxPowerUpCharge*200;this.powerUpBar.fillRect(52,232,t,20)}shootFireball(){if("fire_taco"!==this.activePowerUp||this.powerUpCharge<33.33)return;this.powerUpCharge=Math.max(0,this.powerUpCharge-33.33),this.updatePowerUpBar(),this.powerUpRechargeTimer||this.startPowerUpRecharge();let e=this.fireballs.create(this.player.x+50,this.player.y,"fire_taco");e.setScale(.08),e.setDepth(15),e.body.setVelocityX(600),this.tweens.add({targets:e,scaleX:.12,scaleY:.12,duration:300,yoyo:!0,repeat:-1}),this.sound.play("new_explosion_sfx",{volume:.3}),this.time.delayedCall(2e3,()=>{e&&e.active&&e.destroy()})}startPowerUpRecharge(){this.powerUpRechargeTimer&&this.powerUpRechargeTimer.remove(),this.powerUpRechargeTimer=this.time.addEvent({delay:100,callback:()=>{if("metal_boot"===this.activePowerUp&&0===this.metalBootUses&&(this.powerUpCharge=Math.min(100,this.powerUpCharge+1),this.updatePowerUpBar(),this.powerUpCharge>=100)){var e;this.metalBootUses=3,null===(e=this.powerUpRechargeTimer)||void 0===e||e.remove(),this.powerUpRechargeTimer=void 0}},callbackScope:this,loop:!0})}losePowerUp(){("fire_taco"===this.activePowerUp||this.fireTacoActive)&&this.endFireTacoEffect(),this.activePowerUp=null,this.metalBootActive=!1,this.invulnerable||this.player.setDepth(10),this.fireTacoActive=!1,this.crystalMagnetActive=!1,this.invulnerable||this.player.clearTint(),this.powerUpRechargeTimer&&(this.powerUpRechargeTimer.remove(),this.powerUpRechargeTimer=void 0),this.fireCycleTimer&&(this.fireCycleTimer.remove(),this.fireCycleTimer=void 0)}collectSandwich(e){this.playSFX("bite_sfx",{volume:.5}),this.sandwichesCollected++,this.health=Math.min(this.maxHealth,this.health+40),this.updateHealthBar(),this.score+=25,this.scoreText.setText("Score: "+this.score),this.comboTracker&&this.comboTracker.registerTrick(this.score,this.isGrounded),this.jumpParticles.setPosition(e.x,e.y),this.jumpParticles.explode(15),e.destroy()}createStarSystem(){this.starPickups=this.physics.add.group({allowGravity:!1}),this.starSpawnTimer=this.time.addEvent({delay:3e4,callback:this.spawnStarPattern,callbackScope:this,loop:!0}),this.time.delayedCall(2e4,()=>{this.gameWon||this.spawnStarPattern()}),this.physics.add.overlap(this.player,this.starPickups,(e,t)=>{let s=t.value||1;10===s?this.playSFX("star_cluster_sfx",{volume:.5}):this.playSFX("new_star_sfx",{volume:.4}),this.collectStars(s),t.destroy()},void 0,this)}spawnStarPattern(){if(this.gameWon)return;let e=this.player.x+n.Math.Between(800,1200),t=n.Math.Between(600,750),s=n.Math.Between(3,5);for(let i=0;i<s;i++){let s=this.starPickups.create(e+80*i,t,"star_counter_icon");s.setScale(.036),s.setDepth(9),s.value=1,this.tweens.add({targets:s,y:s.y-10,duration:1e3,ease:"Sine.inOut",yoyo:!0,repeat:-1})}if(.3>Math.random()){let i=this.starPickups.create(e+80*s,t,"star_ten");i.setScale(.15),i.setDepth(9),i.value=10,this.tweens.add({targets:i,y:i.y-15,scale:.12,duration:800,ease:"Sine.inOut",yoyo:!0,repeat:-1})}}collectStars(e){if(this.stars+=e,this.starText.setText(this.stars.toString()),this.challengeManager.updateChallenge("collect_stars",e),this.updateChallengeDisplay(),this.comboTracker&&(this.comboTracker.isActive()||this.comboTracker.isPending())&&this.comboTracker.addStarsToCombo(e),e>1){let t=this.add.text(this.player.x,this.player.y-80,"+".concat(e),{fontSize:"20px",fontFamily:'"Press Start 2P", monospace',color:"#ffff00",stroke:"#000000",strokeThickness:4});t.setOrigin(.5,.5),t.setDepth(20),this.time.delayedCall(500,()=>{this.tweens.add({targets:t,alpha:0,y:t.y-30,duration:1e3,ease:"Power2.easeOut",onComplete:()=>t.destroy()})})}for(;this.stars>=this.nextLifeAt;){this.lives++,this.updateLifeDisplay(),this.nextLifeAt+=this.starLifeThreshold;let e=this.add.text(this.player.x,this.player.y-100,"1UP!",{fontSize:"32px",fontFamily:'"Press Start 2P", monospace',color:"#00ff00",stroke:"#000000",strokeThickness:4});e.setDepth(20),this.tweens.add({targets:e,y:e.y-80,alpha:0,duration:1500,onComplete:()=>e.destroy()})}let t=this.add.graphics();t.x=this.starIcon.x,t.y=this.starIcon.y,t.setDepth(101),t.setScrollFactor(0),t.fillStyle(16777215,.7),t.fillCircle(0,0,25),this.tweens.add({targets:t,alpha:{from:.7,to:0},scale:{from:.5,to:1.5},duration:500,ease:"Cubic.out",onComplete:()=>{t.destroy()}}),this.tweens.add({targets:this.starText,alpha:{from:1,to:.5},duration:200,yoyo:!0,ease:"Sine.inOut"})}updateBackgroundTiles(){if(0===this.backgroundTiles.length)return;let e=this.cameras.main.scrollX;this.backgroundTiles[0];let t=this.backgroundTiles[this.backgroundTiles.length-1];for(;this.backgroundTiles.length>0&&this.backgroundTiles[0].x<e-640;){let e=this.backgroundTiles.shift();e&&e.destroy()}if(this.backgroundTiles.length>0)for(t=this.backgroundTiles[this.backgroundTiles.length-1];t.x<e+1280;){let e=t.x+this.backgroundWidth,s=this.add.image(e,960,"city_background").setOrigin(.5,1).setScrollFactor(1).setDepth(1).setScale(1.1,1.1);this.backgroundTiles.push(s),t=s}}createLifeDisplay(){this.lifeIcon=this.add.image(500,62,"life_icon"),this.lifeIcon.setScale(.12),this.lifeIcon.setDepth(102),this.lifeIcon.setScrollFactor(0),this.lifeText=this.add.text(540,62,this.lives.toString(),{fontSize:"24px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:4}),this.lifeText.setOrigin(0,.5),this.lifeText.setDepth(100),this.lifeText.setScrollFactor(0)}updateLifeDisplay(){this.lifeText&&this.lifeText.setText(this.lives.toString())}respawnPlayer(){this.health=100,this.updateHealthBar(),this.stamina=100,this.updateStaminaBar(),this.challengeManager.resetNoDamageChallenge(),this.challengeManager.resetSurviveChallenge(),this.losePowerUp(),this.gameOverTriggered=!1,this.invulnerable=!0,this.player.clearTint();let e=0,t=this.time.addEvent({delay:150,callback:()=>{++e%2==0?this.player.setAlpha(1):this.player.setAlpha(.5),e>=12&&(this.player.setAlpha(1),this.invulnerable=!1,t.remove())},loop:!0})}cleanupAndStop(){this.gamePaused=!0,this.physics.pause(),this.time.paused=!0,this.shutdown(),this.children.removeAll(),this.scene.stop()}shutdown(){var e,t,s;this.escListener&&(null===(t=this.input.keyboard)||void 0===t||t.off("keydown-ESC",this.escListener),this.escListener=void 0),this.pauseListener&&(null===(s=this.input.keyboard)||void 0===s||s.off("keydown-P",this.pauseListener),this.pauseListener=void 0),null===(e=this.input.keyboard)||void 0===e||e.removeAllListeners(),this.input.removeAllListeners(),this.tweens.killAll(),this.time.removeAllEvents(),this.trickMessageManager&&(this.trickMessageManager.cleanup(),this.trickMessageManager=null),this.fireTacoActive&&this.endFireTacoEffect(),this.activePowerUpTexts&&(this.activePowerUpTexts.forEach(e=>{e.container&&e.container.destroy()}),this.activePowerUpTexts=[]),this.songTitleContainer&&(this.songTitleContainer.destroy(),this.songTitleContainer=void 0),this.stopBackgroundMusic(),this.arrowIndicators&&(this.arrowIndicators.children.entries.forEach(e=>{let t=e.flashTween;t&&(t.stop(),t.remove())}),this.arrowIndicators.clear(!0,!0)),this.enemies&&this.enemies.children.entries.forEach(e=>{if(e.arrow){let t=e.arrow.flashTween;t&&(t.stop(),t.remove()),e.arrow.destroy(),e.arrow=null}}),this.obstacles&&this.obstacles.children.entries.forEach(e=>{if(e.arrow){let t=e.arrow.flashTween;t&&(t.stop(),t.remove()),e.arrow.destroy(),e.arrow=null}}),this.sandwiches&&this.sandwiches.children.entries.forEach(e=>{if(e.arrow){let t=e.arrow.flashTween;t&&(t.stop(),t.remove()),e.arrow.destroy(),e.arrow=null}}),this.energyDrinks&&this.energyDrinks.children.entries.forEach(e=>{if(e.arrow){let t=e.arrow.flashTween;t&&(t.stop(),t.remove()),e.arrow.destroy(),e.arrow=null}}),this.challengeDisplay&&(this.challengeDisplay.destroy(!0),this.challengeDisplay=void 0),this.challengeWaveText&&(this.challengeWaveText.destroy(),this.challengeWaveText=void 0),this.challengeTextBg&&(this.challengeTextBg.destroy(),this.challengeTextBg=void 0),this.challengeDescText&&(this.challengeDescText.destroy(),this.challengeDescText=void 0),this.challengeProgressText&&(this.challengeProgressText.destroy(),this.challengeProgressText=void 0),this.healthBar&&(this.healthBar.destroy(),this.healthBar=void 0),this.healthBarBg&&(this.healthBarBg.destroy(),this.healthBarBg=void 0),this.healthText&&(this.healthText.destroy(),this.healthText=void 0),this.staminaBar&&(this.staminaBar.destroy(),this.staminaBar=void 0),this.staminaBarBg&&(this.staminaBarBg.destroy(),this.staminaBarBg=void 0),this.staminaText&&(this.staminaText.destroy(),this.staminaText=void 0),this.scoreText&&(this.scoreText.destroy(),this.scoreText=void 0),this.distanceText&&(this.distanceText.destroy(),this.distanceText=void 0),this.starIcon&&(this.starIcon.destroy(),this.starIcon=void 0),this.starText&&(this.starText.destroy(),this.starText=void 0),this.lifeIcon&&(this.lifeIcon.destroy(),this.lifeIcon=void 0),this.lifeText&&(this.lifeText.destroy(),this.lifeText=void 0),["pauseBg","pauseTitle","resumeBtn","musicToggle","songsOption","sfxToggle","menuBtn","confirmBg","confirmTitle","confirmText","yesBtn","noBtn","pausedOverlay","pausedText","pauseMenuBg","musicMenuBg","musicTitle","musicBackBtn","songToggle_broken_code","songToggle_undead_empire","songToggle_menu_music","masterMusicToggle"].forEach(e=>{let t=this.children.getByName(e);t&&t.destroy()}),this.waveManager&&(this.waveManager=null),this.challengeManager&&(this.challengeManager=null),this.comboTracker&&(this.comboTracker=null),this.obstacles&&(this.obstacles.clear(!0,!0),this.obstacles=null),this.enemies&&(this.enemies.clear(!0,!0),this.enemies=null),this.sandwiches&&(this.sandwiches.clear(!0,!0),this.sandwiches=null),this.energyDrinks&&(this.energyDrinks.clear(!0,!0),this.energyDrinks=null),this.powerUps&&(this.powerUps.clear(!0,!0),this.powerUps=null),this.starPickups&&(this.starPickups.clear(!0,!0),this.starPickups=null),this.explosions&&(this.explosions.clear(!0,!0),this.explosions=null),this.fireballs&&(this.fireballs.clear(!0,!0),this.fireballs=null),this.groundSegments&&(this.groundSegments.clear(!0,!0),this.groundSegments=null),this.player&&(this.player.destroy(),this.player=null),this.stompHitbox&&(this.stompHitbox.destroy(),this.stompHitbox=null),this.fireBreath&&(this.fireBreath.destroy(),this.fireBreath=null),this.fireSprites&&(this.fireSprites.forEach(e=>{e&&e.destroy()}),this.fireSprites=[]),this.backgroundTiles&&(this.backgroundTiles.forEach(e=>{e&&e.destroy()}),this.backgroundTiles=[]),this.redSkyBg&&(this.redSkyBg.destroy(),this.redSkyBg=null),this.gameOverTriggered=!1,this.gamePaused=!1,this.invulnerable=!1,this.fireTacoActive=!1,this.crystalMagnetActive=!1,this.metalBootActive=!1,this.staminaBoostActive=!1}update(){if(this.gamePaused)return;try{this.waveManager.update(this.game.loop.delta)}catch(e){console.error("[DEBUG] Error updating wave manager:",e)}try{this.challengeManager.updateTimeChallenges(),this.challengeManager.updateNoDamageChallenge()}catch(e){console.error("[DEBUG] Error updating challenges:",e)}if(this.comboTracker){let e=this.comboTracker.getComboState();e.multiplier>1&&this.challengeManager.updateChallenge("get_combo",e.multiplier)}this.trickMessageManager&&this.trickMessageManager.update(this.time.now,0),this.player.body,this.redSkyBg&&(this.redSkyBg.tilePositionX=.3*this.cameras.main.scrollX),this.time.now-this.lastBackgroundUpdate>100&&(this.updateBackgroundTiles(),this.lastBackgroundUpdate=this.time.now),!this.staminaBoostActive&&this.stamina<this.maxStamina&&(this.stamina=Math.min(this.maxStamina,this.stamina+this.staminaRegen)),this.updateStaminaBar(),this.updateHealthBar(),this.time.now-this.lastPowerUpTintUpdate>50&&(this.updatePowerUpTints(),this.lastPowerUpTintUpdate=this.time.now);let e=6.3*this.speedMultiplier;this.player.x+=e,this.player.setVelocityX(380*this.speedMultiplier),(n.Input.Keyboard.JustDown(this.cursors.space)||n.Input.Keyboard.JustDown(this.cursors.up)||this.controls.justTapped())&&this.performJump(),this.controls.justSwipedUp()&&!this.isGrounded&&this.performTrick(),n.Input.Keyboard.JustDown(this.trickKey)&&!this.isGrounded&&this.performTrick(),this.fireTacoActive&&this.updateFireSprites(),this.world.update(this.cameras.main.scrollX),this.trickActive&&this.trickParticles.emitting&&this.trickParticles.setPosition(this.player.x,this.player.y);let t=Math.floor((this.player.x-320)/100);if(t>this.lastDistanceScoreMilestone){let e=t-this.lastDistanceScoreMilestone;this.score+=10*e,this.lastDistanceScoreMilestone=t,this.scoreText.setText("Score: ".concat(this.score))}this.obstacles.children.entries.forEach(e=>{e.x<this.cameras.main.scrollX-200&&(e.getData("fireEffects")&&e.getData("fireEffects").forEach(e=>e.destroy()),this.cleanupObstacleFireEffects(e),this.obstacles.remove(e),e.destroy())}),this.sandwiches.children.entries.forEach(e=>{e.x<this.cameras.main.scrollX-200&&(this.sandwiches.remove(e),e.destroy())}),this.starPickups.children.entries.forEach(e=>{e.x<this.cameras.main.scrollX-200&&(this.starPickups.remove(e),e.destroy())}),this.crystalMagnetActive&&this.starPickups.children.entries.forEach(e=>{e&&e.active&&300>=n.Math.Distance.Between(this.player.x,this.player.y,e.x,e.y)&&!e.magnetizing&&(e.magnetizing=!0,this.tweens.add({targets:e,rotation:2*Math.PI,duration:2e3,ease:"Linear",repeat:-1}),e.magnetTween=this.tweens.add({targets:e,x:this.player.x,y:this.player.y,duration:800,ease:"Power2.easeIn",onUpdate:t=>{let s=t.progress;e.x+=30*Math.sin(s*Math.PI*3)*.1,t.data&&t.data[0]&&(t.data[0].end=this.player.x),t.data&&t.data[1]&&(t.data[1].end=this.player.y)},onComplete:()=>{e&&e.active&&(e.magnetTween=this.tweens.add({targets:e,x:this.player.x,y:this.player.y,duration:600,ease:"Power2.easeIn",onUpdate:e=>{e.data&&e.data[0]&&(e.data[0].end=this.player.x),e.data&&e.data[1]&&(e.data[1].end=this.player.y)},onComplete:()=>{e&&e.active&&this.crystalMagnetActive&&(e.magnetizing=!1)}}))}}))}),this.arrowIndicators.children.entries.forEach(e=>{e.createdTime||(e.createdTime=this.time.now),this.time.now-e.createdTime>3e3&&e.destroy()}),this.enemies.children.entries.forEach((e,t)=>{e.arrow&&e.x<this.player.x+640&&(e.arrow.destroy(),e.arrow=null),e.x<this.cameras.main.scrollX-200&&(e.arrow&&e.arrow.destroy(),this.enemies.remove(e),e.destroy())}),this.player.y>1200&&this.scene.restart();let s=this.player.body;this.isGrounded?s.allowGravity=!1:s.allowGravity=!0,!this.isGrounded&&s.velocity.y>0&&this.player.y+s.velocity.y*this.game.loop.delta/1e3>=850&&(this.player.y=850,this.handleLanding()),this.isGrounded&&(this.player.y=850,this.player.setVelocityY(0),s.velocity.y=0),this.comboTracker&&(this.comboTracker.updateAirState(this.score,this.wasGrounded,this.isGrounded),this.wasGrounded=this.isGrounded,this.updateComboUI())}setupComboUI(){}updateComboUI(){}onWaveChange(e){if(this.waveManager.isWaveComplete()){this.showResultsScreen();return}this.challengeManager.generateChallengesForWave(e);let t=this.time.now-this.gameStartTime,s=this.getDifficulty(t);this.lastDifficulty=-1,this.updateSpawnRate(s),this.updateEnemySpawnRate(s),this.updateChallengeDisplay()}showResultsScreen(){this.invulnerable=!0,this.gameOverTriggered=!0,this.obstacleTimer&&(this.obstacleTimer.remove(),this.obstacleTimer=null),this.enemyTimer&&(this.enemyTimer.remove(),this.enemyTimer=null),this.powerUpTimer&&(this.powerUpTimer.remove(),this.powerUpTimer=null);let e=this.add.graphics();e.fillStyle(0,.8),e.fillRect(0,0,640,960),e.setScrollFactor(0),e.setDepth(300);let t=this.add.container(320,480);t.setScrollFactor(0),t.setDepth(301);let s=this.add.text(0,-200,"WAVES COMPLETE!",{fontSize:"32px",color:"#ffd700",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:4}).setOrigin(.5);t.add(s),["SCORE: ".concat(this.score),"STARS: ".concat(this.stars),"ENEMIES: ".concat(this.enemiesDefeated),"SANDWICHES: ".concat(this.sandwichesCollected),"ENERGY DRINKS: ".concat(this.cansCollected)].forEach((e,s)=>{let i=this.add.text(0,-100+40*s,e,{fontSize:"18px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}).setOrigin(.5);t.add(i)});let i=this.add.graphics();i.fillStyle(5025616,1),i.fillRoundedRect(-150,140,300,60,10),t.add(i);let a=this.add.text(0,170,"CONTINUE",{fontSize:"24px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}).setOrigin(.5);a.setInteractive(),t.add(a),a.on("pointerdown",()=>{this.waveManager.reset(),this.challengeManager.reset(),this.challengeManager.generateChallengesForWave(1),this.hasResetChallengeTimer=!1,this.speedMultiplier=1,e.destroy(),t.destroy(),this.restartSpawning(),this.updateChallengeDisplay()}),a.on("pointerover",()=>{i.clear(),i.fillStyle(6732650,1),i.fillRoundedRect(-150,140,300,60,10)}),a.on("pointerout",()=>{i.clear(),i.fillStyle(5025616,1),i.fillRoundedRect(-150,140,300,60,10)})}restartSpawning(){this.obstacleTimer&&this.obstacleTimer.remove(),this.obstacleTimer=this.time.addEvent({delay:3e3,callback:this.spawnObstacle,callbackScope:this,loop:!0}),this.enemyTimer&&this.enemyTimer.remove(),this.enemyTimer=this.time.addEvent({delay:5e3,callback:this.spawnEnemy,callbackScope:this,loop:!0}),this.powerUpTimer&&this.powerUpTimer.remove(),this.powerUpTimer=this.time.addEvent({delay:2e4,callback:this.spawnPowerUp,callbackScope:this,loop:!0})}updateChallengeDisplay(){var e,t,s;try{this.challengeManager.updateTimeChallenges(),this.challengeManager.updateNoDamageChallenge()}catch(e){console.error("[DEBUG] Error updating time challenges:",e)}if(!this.challengeDisplay||this.challengeWaveText&&!(null===(e=this.challengeWaveText.texture)||void 0===e?void 0:e.frames)||this.challengeDescText&&!(null===(t=this.challengeDescText.texture)||void 0===t?void 0:t.frames)||this.challengeProgressText&&!(null===(s=this.challengeProgressText.texture)||void 0===s?void 0:s.frames)){this.challengeDisplay&&(this.challengeDisplay.destroy(),this.challengeDisplay=void 0),this.challengeDisplay=this.add.container(520,230),this.challengeDisplay.setScrollFactor(0),this.challengeDisplay.setDepth(120);let e=this.add.graphics();e.fillStyle(0,.7),e.fillRoundedRect(-130,-50,250,100,8),this.challengeDisplay.add(e),this.challengeWaveText=this.add.text(0,-30,"WAVE ".concat(this.waveManager.getCurrentWave()),{fontSize:"16px",color:"#ff6b6b",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}),this.challengeWaveText.setOrigin(.5),this.challengeDisplay.add(this.challengeWaveText),this.challengeDescText=this.add.text(0,0,"",{fontSize:"14px",color:"#ffd700",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}),this.challengeDescText.setOrigin(.5),this.challengeDisplay.add(this.challengeDescText),this.challengeProgressText=this.add.text(0,25,"",{fontSize:"16px",color:"#ffd700",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}),this.challengeProgressText.setOrigin(.5),this.challengeDisplay.add(this.challengeProgressText)}if(this.challengeWaveText)try{this.challengeWaveText.setText("WAVE ".concat(this.waveManager.getCurrentWave()))}catch(e){console.error("[DEBUG] Error updating wave text, will recreate on next update:",e),this.challengeWaveText=void 0,this.challengeDisplay=void 0}let i=this.challengeManager.getActiveChallenges().find(e=>!e.completed);if(i){let e="#ffd700",t=i.current;("survive_time"===i.type||"no_damage"===i.type)&&(t=Math.min(Math.floor((this.time.now-this.challengeManager.getStartTime())/1e3),i.target));let s="".concat(t,"/").concat(i.target);if(this.challengeDescText)try{this.challengeDescText.setText(i.description),this.challengeDescText.setColor(e),this.challengeDescText.setVisible(!0)}catch(e){console.error("[DEBUG] Error updating challenge description text, will recreate:",e),this.challengeDescText=void 0,this.challengeDisplay=void 0}if(this.challengeProgressText)try{this.challengeProgressText.setText(s),this.challengeProgressText.setColor(e),this.challengeProgressText.setVisible(!0)}catch(e){console.error("[DEBUG] Error updating progress text, will recreate:",e),this.challengeProgressText=void 0,this.challengeDisplay=void 0}}else{if(this.challengeDescText)try{this.challengeDescText.setText("ALL COMPLETE!"),this.challengeDescText.setColor("#4caf50"),this.challengeDescText.setFontSize("12px"),this.challengeDescText.setVisible(!0)}catch(e){console.error("[DEBUG] Error updating complete text, will recreate:",e),this.challengeDescText=void 0,this.challengeDisplay=void 0}if(this.challengeProgressText)try{this.challengeProgressText.setVisible(!1)}catch(e){console.error("[DEBUG] Error hiding progress text:",e),this.challengeProgressText=void 0}}}showVictoryScreen(){console.log("[VICTORY] Final Wave Complete! Showing victory screen"),this.gameWon=!0,this.obstacleTimer&&this.obstacleTimer.remove(),this.enemyTimer&&this.enemyTimer.remove(),this.sandwichTimer&&this.sandwichTimer.remove(),this.energyDrinkTimer&&this.energyDrinkTimer.remove(),this.powerUpTimer&&this.powerUpTimer.remove(),this.starSpawnTimer&&this.starSpawnTimer.remove(),this.enemies.clear(!0,!0),this.obstacles.clear(!0,!0),this.powerUps.clear(!0,!0);let e=this.add.text(320,480,"VICTORY!",{fontSize:"48px",color:"#00ff00",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:8}).setOrigin(.5).setScrollFactor(0).setDepth(300);this.tweens.add({targets:e,scaleX:1.5,scaleY:1.5,duration:500,yoyo:!0,repeat:2,onComplete:()=>{e.destroy(),this.showFinalStats()}})}showFinalStats(){this.add.rectangle(320,480,600,500,0,.8).setScrollFactor(0).setDepth(400),this.add.text(320,300,"GAME COMPLETE!",{fontSize:"32px",color:"#ffff00",fontFamily:'"Press Start 2P", monospace'}).setOrigin(.5).setScrollFactor(0).setDepth(401);let e=Math.floor((this.time.now-this.gameStartTime)/1e3),t="".concat(Math.floor(e/60),":").concat((e%60).toString().padStart(2,"0"));["FINAL SCORE: ".concat(this.score),"TIME TAKEN: ".concat(t),"STARS COLLECTED: ".concat(this.stars),"ENEMIES CRUSHED: ".concat(this.totalEnemiesStomped),"BEST COMBO: ".concat(this.bestCombo,"X"),"POWER-UPS USED: ".concat(this.totalPowerUpsUsed)].forEach((e,t)=>{this.add.text(320,360+30*t,e,{fontSize:"16px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace'}).setOrigin(.5).setScrollFactor(0).setDepth(401)});let s=this.add.text(320,550,"PLAY AGAIN",{fontSize:"20px",color:"#00ff00",fontFamily:'"Press Start 2P", monospace',backgroundColor:"#000000",padding:{x:15,y:10}}).setOrigin(.5).setScrollFactor(0).setDepth(401);s.setInteractive({useHandCursor:!0}),s.on("pointerover",()=>{s.setScale(1.1),s.setColor("#ffff00")}),s.on("pointerout",()=>{s.setScale(1),s.setColor("#00ff00")}),s.on("pointerdown",()=>{this.sound.stopAll(),this.scene.restart()});let i=this.add.text(320,600,"MAIN MENU",{fontSize:"20px",color:"#00ff00",fontFamily:'"Press Start 2P", monospace',backgroundColor:"#000000",padding:{x:15,y:10}}).setOrigin(.5).setScrollFactor(0).setDepth(401);i.setInteractive({useHandCursor:!0}),i.on("pointerover",()=>{i.setScale(1.1),i.setColor("#ffff00")}),i.on("pointerout",()=>{i.setScale(1),i.setColor("#00ff00")}),i.on("pointerdown",()=>{this.sound.stopAll(),this.scene.start("MainMenu")})}constructor(){super("Game"),this.selectedCharacter="kev",this.isGrounded=!0,this.hasDoubleJumped=!1,this.trickActive=!1,this.hasUsedTrick=!1,this.jumpCount=0,this.maxJumps=2,this.jumpDebounce=!1,this.jumpScale=.4,this.obstacleTypes=["obstacle_cone","obstacle_trash","obstacle_crash","obstacle_zombie","obstacle_skulls"],this.recentObstacles=[],this.lastObstacleX=0,this.gameOverTriggered=!1,this.gamePaused=!1,this.sfxEnabled=!0,this.musicEnabled=!0,this.gameStartTime=0,this.score=0,this.lastDifficulty=-1,this.obstacleTimer=null,this.enemyTimer=null,this.lastEnemyX=0,this.lastEnemyY=0,this.lastEnemySpawnTime=0,this.lastSandwichY=0,this.lastSandwichSpawnTime=0,this.lastEnergyDrinkY=0,this.lastEnergyDrinkSpawnTime=0,this.bounceVelocity=-1200,this.speedMultiplier=1,this.stamina=100,this.maxStamina=100,this.staminaCost=33.33,this.staminaRegen=.5,this.lastStaminaWarnPlayed=0,this.lastStaminaFullPlayed=0,this.health=100,this.maxHealth=100,this.invulnerable=!1,this.invulnerableTime=1500,this.sandwichesCollected=0,this.cansCollected=0,this.enemiesDefeated=0,this.staminaBoostActive=!1,this.crystalMagnetActive=!1,this.activePowerUp=null,this.powerUpCharge=0,this.maxPowerUpCharge=100,this.metalBootUses=0,this.lastPowerUpSpawnTime=0,this.powerUpTimer=null,this.isStomping=!1,this.fireBreathActive=!1,this.metalBootActive=!1,this.fireTacoActive=!1,this.fireSprites=[],this.enemySpawnRate=1,this.powerUpTestIndex=0,this.lastFireSpriteUpdate=0,this.lastPowerUpTintUpdate=0,this.lastBackgroundUpdate=0,this.activePowerUpTexts=[],this.wasGrounded=!0,this.lastComboData=null,this.stars=0,this.lastStarPatternX=0,this.gameWon=!1,this.totalEnemiesStomped=0,this.bestCombo=0,this.totalPowerUpsUsed=0,this.lives=3,this.starLifeThreshold=100,this.nextLifeAt=100,this.lastDistanceScoreMilestone=0,this.backgroundTiles=[],this.backgroundWidth=1408,this.redSkyBg=null,this.JUMP_VELOCITY=-1750,this.TRICK_JUMP_VELOCITY=-1450,this.SWIPE_TRICK_VELOCITY=-850,this.GRAVITY=4200,this.FLOAT_GRAVITY=3200,this.bgMusicQueue=["broken_code","undead_empire","menu_music"],this.currentMusicIndex=0,this.songEnabled={broken_code:!0,undead_empire:!0,menu_music:!0},this.lastChallengeDisplayUpdate=0,this.challengeDisplayUpdatePending=!1,this.challengeDisplayUpdateDelay=200,this.hasResetChallengeTimer=!1}}class D extends n.Scene{init(e){this.finalScore=e.score||0,this.survivalTime=e.time||0,this.sandwichesCollected=e.sandwiches||0,this.cansCollected=e.cans||0,this.starsCollected=e.stars||0,this.enemiesDefeated=e.enemies||0,this.selectedOption=0,this.playAgainText=void 0,this.mainMenuText=void 0,this.selector=void 0}create(){console.log("[GameOver Scene] Dispatching gameOver event with score:",this.finalScore),window.dispatchEvent(new CustomEvent("gameOver",{detail:{score:this.finalScore}})),this.add.image(320,480,"game_over_bg").setDisplaySize(640,960);let e=this.add.graphics();e.fillStyle(0,.6),e.fillRoundedRect(60,280,520,450,15),this.add.text(320,200,"GAME OVER",{fontFamily:'"Press Start 2P", monospace',fontSize:"40px",color:"#ff0000",stroke:"#ffffff",strokeThickness:6}).setOrigin(.5).setShadow(3,3,"#000000",5,!0,!0),this.add.text(320,320,"RESULTS",{fontFamily:'"Press Start 2P", monospace',fontSize:"28px",color:"#ffff00",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(2,2,"#000000",4,!0,!0),this.add.text(320,400,"SCORE: ".concat(Math.floor(this.finalScore)),{fontFamily:'"Press Start 2P", monospace',fontSize:"22px",color:"#ffffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0);let t=Math.floor(this.survivalTime/6e4),s=Math.floor(this.survivalTime%6e4/1e3),i="".concat(t,":").concat(s.toString().padStart(2,"0"));this.add.text(320,450,"TIME: ".concat(i),{fontFamily:'"Press Start 2P", monospace',fontSize:"20px",color:"#ffffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0),this.add.text(320,495,"ENEMIES: ".concat(this.enemiesDefeated),{fontFamily:'"Press Start 2P", monospace',fontSize:"20px",color:"#ff6600",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0),this.add.text(320,535,"SANDWICHES: ".concat(this.sandwichesCollected),{fontFamily:'"Press Start 2P", monospace',fontSize:"18px",color:"#ffffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0),this.add.text(320,575,"ENERGY DRINKS: ".concat(this.cansCollected),{fontFamily:'"Press Start 2P", monospace',fontSize:"18px",color:"#00ffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0),this.add.text(320,620,"STARS: ".concat(this.starsCollected),{fontFamily:'"Press Start 2P", monospace',fontSize:"24px",color:"#ffff00",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0),this.playAgainText=this.add.text(320,750,"PLAY AGAIN",{fontFamily:'"Press Start 2P", monospace',fontSize:"20px",color:"#ffffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5),this.playAgainText.setShadow(2,2,"#000000",3,!0,!0),this.playAgainText.setInteractive({useHandCursor:!0}),this.playAgainText.on("pointerdown",()=>this.playAgain()),this.playAgainText.on("pointerover",()=>{this.selectedOption=0,this.updateSelection()}),this.mainMenuText=this.add.text(320,810,"MAIN MENU",{fontFamily:'"Press Start 2P", monospace',fontSize:"20px",color:"#ffffff",stroke:"#000000",strokeThickness:4}).setOrigin(.5),this.mainMenuText.setShadow(2,2,"#000000",3,!0,!0),this.mainMenuText.setInteractive({useHandCursor:!0}),this.mainMenuText.on("pointerdown",()=>this.goToMainMenu()),this.mainMenuText.on("pointerover",()=>{this.selectedOption=1,this.updateSelection()}),this.selector=this.add.text(120,750,"▶",{fontFamily:'"Press Start 2P", monospace',fontSize:"24px",color:"#ffff00"}),this.upKey=this.input.keyboard.addKey(n.Input.Keyboard.KeyCodes.UP),this.downKey=this.input.keyboard.addKey(n.Input.Keyboard.KeyCodes.DOWN),this.spaceKey=this.input.keyboard.addKey(n.Input.Keyboard.KeyCodes.SPACE),this.enterKey=this.input.keyboard.addKey(n.Input.Keyboard.KeyCodes.ENTER),this.updateSelection()}update(){n.Input.Keyboard.JustDown(this.upKey)?(this.selectedOption=Math.max(0,this.selectedOption-1),this.updateSelection()):n.Input.Keyboard.JustDown(this.downKey)&&(this.selectedOption=Math.min(1,this.selectedOption+1),this.updateSelection()),(n.Input.Keyboard.JustDown(this.spaceKey)||n.Input.Keyboard.JustDown(this.enterKey))&&(0===this.selectedOption?this.playAgain():1===this.selectedOption&&this.goToMainMenu())}updateSelection(){this.playAgainText&&this.mainMenuText&&this.selector&&(this.playAgainText.setColor("#ffffff"),this.mainMenuText.setColor("#ffffff"),this.selector.setPosition(120,[750,810][this.selectedOption]),0===this.selectedOption?this.playAgainText.setColor("#ffff00"):1===this.selectedOption&&this.mainMenuText.setColor("#ffff00"))}playAgain(){this.scene.start("CharacterSelect")}goToMainMenu(){this.scene.start("MainMenu")}constructor(){super("GameOver"),this.finalScore=0,this.survivalTime=0,this.sandwichesCollected=0,this.cansCollected=0,this.starsCollected=0,this.enemiesDefeated=0,this.selectedOption=0}}class B extends Phaser.Scene{init(e){this.menuMusic=e.menuMusic||null}create(){var e,t,s,i;window.dispatchEvent(new CustomEvent("sceneChanged",{detail:{scene:"OptionsMenu"}})),this.add.image(320,480,"graffiti_bg").setDisplaySize(640,960),this.add.text(320,200,"OPTIONS",{fontSize:"32px",color:"#ffecb3",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(3,3,"#000000",5,!0,!0);let a=this.add.text(320,320,"HOW TO PLAY",{fontSize:"20px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5);a.setShadow(2,2,"#000000",3,!0,!0);let r=this.add.text(320,390,"LEADERBOARD",{fontSize:"20px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5);r.setShadow(2,2,"#000000",3,!0,!0);let o=this.add.text(320,460,"GO BACK",{fontSize:"22px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);o.setShadow(2,2,"#000000",3,!0,!0),this.menuItems=[a,r,o];let n=this.add.text(120,320,">",{fontSize:"24px",color:"#ffff00",fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:3}).setOrigin(.5);n.setShadow(2,2,"#000000",3,!0,!0);let l=()=>{a.setStyle({color:"#ffffff",fontFamily:'"Press Start 2P", monospace'}),r.setStyle({color:"#ffffff",fontFamily:'"Press Start 2P", monospace'}),o.setStyle({color:"#ffffff",fontFamily:'"Press Start 2P", monospace'}),0===this.selectedOption?(n.setY(320),a.setStyle({color:"#00ff00",fontFamily:'"Press Start 2P", monospace'})):1===this.selectedOption?(n.setY(390),r.setStyle({color:"#00ff00",fontFamily:'"Press Start 2P", monospace'})):2===this.selectedOption&&(n.setY(460),o.setStyle({color:"#00ff00",fontFamily:'"Press Start 2P", monospace'}))};l(),a.setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.start("HowToPlay",{menuMusic:this.menuMusic})}).on("pointerover",()=>{this.selectedOption=0,l()}),r.setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.start("Leaderboard",{menuMusic:this.menuMusic})}).on("pointerover",()=>{this.selectedOption=1,l()}),o.setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.start("MainMenu",{menuMusic:this.menuMusic})}).on("pointerover",()=>{this.selectedOption=2,l()});let h=null===(e=this.input.keyboard)||void 0===e?void 0:e.addKey("UP"),c=null===(t=this.input.keyboard)||void 0===t?void 0:t.addKey("DOWN"),d=null===(s=this.input.keyboard)||void 0===s?void 0:s.addKey("SPACE"),p=null===(i=this.input.keyboard)||void 0===i?void 0:i.addKey("ENTER");null==h||h.on("down",()=>{this.selectedOption=(this.selectedOption-1+this.menuItems.length)%this.menuItems.length,l()}),null==c||c.on("down",()=>{this.selectedOption=(this.selectedOption+1)%this.menuItems.length,l()});let m=()=>{0===this.selectedOption?this.scene.start("HowToPlay",{menuMusic:this.menuMusic}):1===this.selectedOption?this.scene.start("Leaderboard",{menuMusic:this.menuMusic}):this.scene.start("MainMenu",{menuMusic:this.menuMusic})};null==d||d.on("down",m),null==p||p.on("down",m),this.cursors=this.input.keyboard.createCursorKeys()}update(){Phaser.Input.Keyboard.JustDown(this.input.keyboard.addKey("ESC"))&&this.scene.start("MainMenu",{menuMusic:this.menuMusic})}constructor(){super({key:"OptionsMenu"}),this.menuMusic=null,this.selectedOption=0,this.menuItems=[]}}class F extends Phaser.Scene{init(e){this.menuMusic=e.menuMusic||null}create(){var e,t,s,i,a;this.add.image(320,480,"graffiti_bg").setDisplaySize(640,960),this.add.text(320,60,"HOW TO PLAY",{fontSize:"24px",color:"#ffecb3",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(3,3,"#000000",5,!0,!0),this.page1Container=this.add.container(0,0),this.page2Container=this.add.container(0,0),this.page3Container=this.add.container(0,0);let r=this.add.graphics();r.fillStyle(0,.6),r.fillRoundedRect(40,110,560,630,15),this.page1Container.add(r);let o=this.add.text(320,130,"SURVIVE AS LONG AS POSSIBLE!\nCOLLECT STARS, AVOID OBSTACLES",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);o.setShadow(2,2,"#000000",4,!0,!0),this.page1Container.add(o);let n=220,l=this.add.image(100,n,"star_counter_icon");l.setScale(.1),this.page1Container.add(l);let h=this.add.text(180,n,"STARS\nCOLLECT 100 FOR EXTRA LIFE",{fontSize:"16px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"left",stroke:"#000000",strokeThickness:2}).setOrigin(0,.5);h.setShadow(2,2,"#000000",3,!0,!0),this.page1Container.add(h),n+=110;let c=this.add.image(100,n,"sandwich");c.setScale(.13),this.page1Container.add(c);let d=this.add.text(180,n,"SANDWICH\nRESTORES HEALTH",{fontSize:"16px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"left",stroke:"#000000",strokeThickness:2}).setOrigin(0,.5);d.setShadow(2,2,"#000000",3,!0,!0),this.page1Container.add(d),n+=120;let p=this.add.image(100,n,"energy_drink");p.setScale(.13),this.page1Container.add(p);let m=this.add.text(180,n,"ENERGY DRINK\nSTAMINA BOOST + INVINCIBLE",{fontSize:"16px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"left",stroke:"#000000",strokeThickness:2}).setOrigin(0,.5);m.setShadow(2,2,"#000000",3,!0,!0),this.page1Container.add(m),n+=130;let g=this.add.text(320,n,"CONTROLS",{fontSize:"20px",color:"#ffecb3",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5);g.setShadow(2,2,"#000000",4,!0,!0),this.page1Container.add(g),n+=60;let u=this.add.text(320,n,"TAP/SPACE: JUMP\nSWIPE UP/J KEY: TRICK (IN AIR)\nSTOMP ON ENEMIES TO DEFEAT",{fontSize:"16px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);u.setShadow(2,2,"#000000",3,!0,!0),this.page1Container.add(u),n+=70;let f=this.add.text(320,n,"COMBINING TRICKS AND KILLS\nSTARTS COMBOS",{fontSize:"12px",color:"#ffff00",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);f.setShadow(2,2,"#000000",3,!0,!0),this.page1Container.add(f);let y=this.add.graphics();y.fillStyle(0,.6),y.fillRoundedRect(40,110,560,630,15),this.page2Container.add(y);let x=this.add.text(320,130,"POWER-UPS",{fontSize:"20px",color:"#ffecb3",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5);x.setShadow(2,2,"#000000",4,!0,!0),this.page2Container.add(x),n=220;let b=this.add.image(100,n,"crystal_magnet");b.setScale(.12),this.page2Container.add(b);let S=this.add.text(180,n,"STAR MAGNET\nATTRACTS NEARBY STARS",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"left",stroke:"#000000",strokeThickness:2,lineSpacing:5}).setOrigin(0,.5);S.setShadow(2,2,"#000000",3,!0,!0),this.page2Container.add(S),n+=150;let w=this.add.image(115,n,"metal_skateboard");w.setScale(.2),this.page2Container.add(w);let T=this.add.text(180,n,"METAL GEAR\nINVINCIBLE TO DAMAGE FROM\nALL FLOOR OBSTACLES",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"left",stroke:"#000000",strokeThickness:2,lineSpacing:5}).setOrigin(0,.5);T.setShadow(2,2,"#000000",3,!0,!0),this.page2Container.add(T),n+=150;let v=this.add.image(100,n,"fire_taco");v.setScale(.12),this.page2Container.add(v);let k=this.add.text(180,n,"FLAMING TACO\nBURN ENEMIES ON TOUCH\nTHANKS TO ROOSTER\nCARTEL MANGA\nHABANERO SALSA",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"left",stroke:"#000000",strokeThickness:2,lineSpacing:5}).setOrigin(0,.5);k.setShadow(2,2,"#000000",3,!0,!0),this.page2Container.add(k);let C=this.add.text(320,670,"POWER-UPS SPAWN RANDOMLY\nWATCH FOR WARNING SIGNS!",{fontSize:"16px",color:"#ffff00",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);C.setShadow(2,2,"#000000",3,!0,!0),this.page2Container.add(C),this.page2Container.setVisible(!1);let E=this.add.graphics();E.fillStyle(0,.6),E.fillRoundedRect(40,110,560,630,15),this.page3Container.add(E);let P=this.add.text(320,130,"WAVE SYSTEM",{fontSize:"20px",color:"#ffecb3",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5);P.setShadow(2,2,"#000000",4,!0,!0),this.page3Container.add(P),n=190;let _=this.add.text(320,n,"READY TO CONQUER THE STREETS?",{fontSize:"12px",color:"#ff00ff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);_.setShadow(2,2,"#000000",3,!0,!0),this.page3Container.add(_),n+=60;let M=this.add.text(320,n,"HOW IT WORKS",{fontSize:"18px",color:"#00ff00",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);M.setShadow(2,2,"#000000",3,!0,!0),this.page3Container.add(M),n+=50;let O=this.add.text(320,n,"EACH WAVE IS DIFFERENT!",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2,lineSpacing:8}).setOrigin(.5);O.setShadow(2,2,"#000000",3,!0,!0),this.page3Container.add(O),n+=80;let D=this.add.text(320,n,"DO COOL STUFF TO\nADVANCE TO NEXT WAVE\n\nEXAMPLES:\nSTOMP ENEMIES! COLLECT STARS!\nDO TRICKS! SURVIVE!",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2,lineSpacing:8}).setOrigin(.5);D.setShadow(2,2,"#000000",3,!0,!0),this.page3Container.add(D),n+=140;let B=this.add.text(320,n,"SHRED & SURVIVE!",{fontSize:"18px",color:"#ff0000",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5);B.setShadow(2,2,"#000000",3,!0,!0),this.page3Container.add(B),n+=50;let F=this.add.text(320,n,"EACH WAVE GETS FASTER\nMORE ENEMIES SPAWN\nUNLOCK POWER-UPS!",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2,lineSpacing:8}).setOrigin(.5);F.setShadow(2,2,"#000000",3,!0,!0),this.page3Container.add(F),n+=85;let A=this.add.text(320,n,"BEAT ALL 3 WAVES\nTO CLAIM DESTINY!",{fontSize:"18px",color:"#ff00ff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3,lineSpacing:8}).setOrigin(.5);A.setShadow(3,3,"#000000",4,!0,!0),this.page3Container.add(A),this.page3Container.setVisible(!1),this.pageText=this.add.text(320,800,"Page 1/3",{fontSize:"14px",color:"#ffffff",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5),this.pageText.setShadow(2,2,"#000000",3,!0,!0),this.leftArrow=this.add.text(200,800,"<",{fontSize:"24px",color:"#00ff00",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5),this.leftArrow.setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.previousPage()).on("pointerover",()=>this.leftArrow.setColor("#ffff00")).on("pointerout",()=>this.leftArrow.setColor(1===this.currentPage?"#808080":"#00ff00")),this.leftArrow.setColor("#808080"),this.rightArrow=this.add.text(440,800,">",{fontSize:"24px",color:"#00ff00",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5),this.rightArrow.setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.nextPage()).on("pointerover",()=>this.rightArrow.setColor("#ffff00")).on("pointerout",()=>this.rightArrow.setColor(this.currentPage===this.totalPages?"#808080":"#00ff00"));let U=this.add.text(320,850,"BACK TO OPTIONS",{fontSize:"20px",color:"#00ff00",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5);U.setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.start("OptionsMenu",{menuMusic:this.menuMusic})}).on("pointerover",()=>{U.setColor("#ffff00")}).on("pointerout",()=>{U.setColor("#00ff00")});let I=null===(e=this.input.keyboard)||void 0===e?void 0:e.addKey("SPACE"),N=null===(t=this.input.keyboard)||void 0===t?void 0:t.addKey("ENTER"),R=null===(s=this.input.keyboard)||void 0===s?void 0:s.addKey("ESC"),j=()=>{this.scene.start("OptionsMenu",{menuMusic:this.menuMusic})};null==I||I.on("down",j),null==N||N.on("down",j),null==R||R.on("down",j),this.cursors=this.input.keyboard.createCursorKeys();let G=null===(i=this.input.keyboard)||void 0===i?void 0:i.addKey("LEFT"),L=null===(a=this.input.keyboard)||void 0===a?void 0:a.addKey("RIGHT");null==G||G.on("down",()=>this.previousPage()),null==L||L.on("down",()=>this.nextPage())}previousPage(){this.currentPage>1&&(this.currentPage--,this.updatePage())}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updatePage())}updatePage(){this.page1Container.setVisible(1===this.currentPage),this.page2Container.setVisible(2===this.currentPage),this.page3Container.setVisible(3===this.currentPage),this.pageText.setText("Page ".concat(this.currentPage,"/").concat(this.totalPages)),this.leftArrow.setColor(1===this.currentPage?"#808080":"#00ff00"),this.rightArrow.setColor(this.currentPage===this.totalPages?"#808080":"#00ff00")}constructor(){super({key:"HowToPlay"}),this.menuMusic=null,this.currentPage=1,this.totalPages=3}}class A extends n.Scene{init(e){this.menuMusic=e.menuMusic||null}async create(){this.add.image(320,480,"graffiti_bg").setDisplaySize(640,960);let e=this.add.graphics();e.fillStyle(0,.6),e.fillRoundedRect(50,170,540,620,15),this.add.text(320,120,"LEADERBOARD",{fontSize:"28px",color:"#ffecb3",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:4}).setOrigin(.5).setShadow(3,3,"#000000",5,!0,!0);let t=this.add.text(320,350,"LOADING...",{fontSize:"20px",color:"#b9c0cf",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5);t.setShadow(2,2,"#000000",3,!0,!0),this.add.text(320,850,"GO BACK",{fontSize:"22px",color:"#e2e28e",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:2}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0),this.cursors=this.input.keyboard.createCursorKeys(),this.input.on("pointerdown",()=>{this.scene.start("MainMenu",{menuMusic:this.menuMusic})}),console.log("[Leaderboard] Requesting blockchain leaderboard data");let s=e=>{console.log("[Leaderboard] Received leaderboard data:",e.detail),window.removeEventListener("leaderboardData",s),this.leaderboardData=e.detail.leaderboard||[],this.isLoading=!1,t.destroy(),this.displayLeaderboard()},i=e=>{console.error("[Leaderboard] Error fetching leaderboard:",e.detail),window.removeEventListener("leaderboardError",i),this.isLoading=!1,t.setText("FAILED TO LOAD\nLEADERBOARD\n\nCONNECT WALLET"),t.setColor("#ff0000")};window.addEventListener("leaderboardData",s),window.addEventListener("leaderboardError",i),window.dispatchEvent(new CustomEvent("requestLeaderboard"))}displayLeaderboard(){if(0===this.leaderboardData.length){this.add.text(320,350,"NO SCORES YET!\nBE THE FIRST!",{fontSize:"18px",color:"#b9c0cf",fontFamily:'"Press Start 2P", monospace',align:"center",stroke:"#000000",strokeThickness:3}).setOrigin(.5).setShadow(2,2,"#000000",3,!0,!0);return}let e=200;this.leaderboardData.forEach((t,s)=>{let i=s+1,a="#ffffff";1===i?a="#ffd700":2===i?a="#c0c0c0":3===i&&(a="#cd7f32");let r=t.address?"".concat(t.address.slice(0,6),"...").concat(t.address.slice(-4)):"Unknown";this.add.text(80,e,"".concat(i,"."),{fontSize:"16px",color:a,fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:2}).setOrigin(0,.5).setShadow(2,2,"#000000",2,!0,!0),this.add.text(130,e,r,{fontSize:"16px",color:a,fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:2}).setOrigin(0,.5).setShadow(2,2,"#000000",2,!0,!0),this.add.text(560,e,Math.floor(t.score).toString(),{fontSize:"16px",color:a,fontFamily:'"Press Start 2P", monospace',stroke:"#000000",strokeThickness:2}).setOrigin(1,.5).setShadow(2,2,"#000000",2,!0,!0),e+=45})}update(){n.Input.Keyboard.JustDown(this.input.keyboard.addKey("ESC"))&&this.scene.start("MainMenu",{menuMusic:this.menuMusic})}constructor(){super({key:"Leaderboard"}),this.menuMusic=null,this.leaderboardData=[],this.isLoading=!0}}let U="0xdE9e4C3ce781b4bA68120d6261cbad65ce0aB00b",I=[{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],N=[{inputs:[],name:"payEntry",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"score",type:"uint256"}],name:"submitScore",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getCurrentLeaderboard",outputs:[{components:[{internalType:"address",name:"playerAddress",type:"address"},{internalType:"uint256",name:"score",type:"uint256"},{internalType:"uint256",name:"timestamp",type:"uint256"}],internalType:"struct DailyTournament.Player[10]",name:"",type:"tuple[10]"}],stateMutability:"view",type:"function"}];function R(e){let{contractAddress:t}=e;t="0xcC36a406684c313f29848c2A0AfBdFc9A3B5503B";let s=(0,o.useRef)(null),a=(0,o.useRef)(null),[E,P]=(0,o.useState)(!1),[_,M]=(0,o.useState)(!1),[R,j]=(0,o.useState)(!1),[G,L]=(0,o.useState)(0),[z,W]=(0,o.useState)(!1),[K,Y]=(0,o.useState)({show:!1,title:"",message:"",type:"info"}),[V,H]=(0,o.useState)(!0),{address:X,isConnected:J,chain:q}=(0,l.m)(),{writeContract:Q,data:Z,error:$}=(0,h.S)(),{writeContract:ee,data:et,error:es}=(0,h.S)(),{writeContract:ei,data:ea,error:er}=(0,h.S)(),{isMiniPay:eo}=(0,g.w)(),en=(0,c.Z)();(0,o.useEffect)(()=>{if(eo){let e=setTimeout(()=>H(!1),3e3);return()=>clearTimeout(e)}},[eo]),(0,o.useEffect)(()=>{if(X){let e="hasStaked_".concat(X,"_").concat(t);"true"===localStorage.getItem(e)&&P(!0)}},[X,t]);let{isLoading:el,isSuccess:eh}=(0,d.A)({hash:Z}),{isLoading:ec,isSuccess:ed}=(0,d.A)({hash:et}),{isLoading:ep,isSuccess:em}=(0,d.A)({hash:ea});(0,o.useEffect)(()=>{eh&&Z&&X&&(async()=>{if(await new Promise(e=>setTimeout(e,2e3)),Number(await (0,m.L)(en,{address:U,abi:[{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"}],functionName:"balanceOf",args:[X]}))/1e18<1)return Y({show:!0,title:"Low Balance",message:"Need 1+ cUSD",type:"error"});ee({address:t,abi:N,functionName:"payEntry",feeCurrency:U})})()},[eh,Z,X,en,t,ee]),(0,o.useEffect)(()=>{ed&&X&&(P(!0),localStorage.setItem("hasStaked_".concat(X,"_").concat(t),"true"),Y({show:!0,title:"Staked!",message:"1 cUSD paid. Select character to start!",type:"success"}))},[ed,X,t]),(0,o.useEffect)(()=>{em&&(W(!1),j(!1),Y({show:!0,title:"Score Submitted!",message:"Your score: ".concat(G.toLocaleString()),type:"success"}))},[em,G]);let eg=(0,o.useRef)(J),eu=(0,o.useRef)(E);(0,o.useEffect)(()=>{eg.current=J},[J]),(0,o.useEffect)(()=>{eu.current=E},[E]),(0,o.useEffect)(()=>{if(!a.current||s.current)return;let e={type:n.AUTO,parent:a.current,width:640,height:960,backgroundColor:"#000000",physics:{default:"arcade",arcade:{gravity:{x:0,y:2e3}}},scene:[x,b,S,w,T,v,k,C,O,D,B,F,A],scale:{mode:n.Scale.FIT,autoCenter:n.Scale.CENTER_BOTH}};s.current=new n.Game(e);let t=()=>{eg.current&&eu.current?window.dispatchEvent(new CustomEvent("stakeConfirmed")):eg.current?M(!0):H(!0)},i=e=>{L(e.detail.score),eg.current&&eu.current&&j(!0)};return window.addEventListener("gameStartRequested",t),window.addEventListener("gameOver",i),()=>{var e;window.removeEventListener("gameStartRequested",t),window.removeEventListener("gameOver",i),null===(e=s.current)||void 0===e||e.destroy(!0),s.current=null}},[]);let ef=async()=>{J&&X&&(M(!1),Q({address:U,abi:I,functionName:"approve",args:[t,(0,p.f)("1")],feeCurrency:U}))},ey=async()=>{W(!0),ei({address:t,abi:N,functionName:"submitScore",args:[BigInt(Math.floor(G))],feeCurrency:U})};return(0,i.jsxs)("div",{className:"jsx-ba7130e2f196124a relative w-full h-screen bg-black flex items-center justify-center",children:[(0,i.jsx)("div",{ref:a,className:"jsx-ba7130e2f196124a game-container"}),(V||!J)&&eo&&(0,i.jsx)("div",{className:"jsx-ba7130e2f196124a absolute inset-0 bg-black bg-opacity-95 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"jsx-ba7130e2f196124a bg-gradient-to-br from-green-600 to-emerald-700 p-8 rounded-2xl text-center max-w-sm mx-4 shadow-2xl",children:[(0,i.jsx)("h2",{className:"jsx-ba7130e2f196124a text-3xl font-bold text-white mb-4",children:"Ready to Play?"}),(0,i.jsx)("p",{className:"jsx-ba7130e2f196124a text-white mb-8 opacity-90 text-lg",children:"Tap below to connect your MiniPay wallet and start earning!"}),(0,i.jsx)("button",{onClick:async()=>{try{await window.ethereum.request({method:"eth_requestAccounts"}),H(!1),window.location.reload()}catch(e){console.error("Connect failed:",e)}},className:"jsx-ba7130e2f196124a bg-white text-green-700 font-bold text-xl px-8 py-4 rounded-full hover:scale-105 transition-transform shadow-lg",children:"Connect Wallet"})]})}),!J&&!eo&&(0,i.jsx)("div",{className:"jsx-ba7130e2f196124a absolute top-4 left-0 right-0 text-center px-4",children:(0,i.jsx)("div",{className:"jsx-ba7130e2f196124a bg-yellow-500 text-black px-6 py-3 rounded-lg inline-block font-bold text-sm sm:text-base",children:"Connect your wallet to play CeloRiders!"})}),J&&!E&&!eo&&(0,i.jsx)("div",{className:"jsx-ba7130e2f196124a absolute top-4 left-0 right-0 text-center px-4",children:(0,i.jsx)("div",{className:"jsx-ba7130e2f196124a bg-blue-500 text-white px-6 py-3 rounded-lg inline-block font-bold text-sm sm:text-base",children:"Stake 1 cUSD to play!"})}),(0,i.jsx)(u,{isOpen:_,onConfirm:ef,onCancel:()=>M(!1),isMiniPay:eo}),(0,i.jsx)(f,{isOpen:R,score:G,onConfirm:ey,onCancel:()=>j(!1),isSubmitting:z}),(0,i.jsx)(y,{isOpen:K.show,title:K.title,message:K.message,type:K.type,onClose:()=>Y({...K,show:!1})}),(el||ec||ep)&&(0,i.jsx)("div",{className:"jsx-ba7130e2f196124a absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,i.jsxs)("div",{className:"jsx-ba7130e2f196124a bg-white text-black p-8 rounded-lg text-center",children:[(0,i.jsx)("div",{className:"jsx-ba7130e2f196124a animate-spin rounded-full h-12 w-12 border-b-4 border-green-500 mx-auto mb-4"}),(0,i.jsx)("p",{className:"jsx-ba7130e2f196124a font-bold text-lg",children:el?"Approve cUSD...":ec?"Paying entry...":"Submitting score..."})]})}),J&&(0,i.jsxs)("div",{className:"jsx-ba7130e2f196124a absolute bottom-4 right-4 bg-white bg-opacity-10 text-white px-4 py-2 rounded-lg text-sm font-mono",children:[null==X?void 0:X.slice(0,6),"...",null==X?void 0:X.slice(-4),E&&(0,i.jsx)("span",{className:"jsx-ba7130e2f196124a block text-green-400 text-xs",children:"Staked"})]}),(0,i.jsx)(r(),{id:"ba7130e2f196124a",children:".game-container.jsx-ba7130e2f196124a{max-width:100vw;max-height:100vh}"})]})}},71178:function(e,t,s){s.d(t,{w:function(){return a}});var i=s(99151);function a(){let[e,t]=(0,i.useState)(!1),[s,a]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{{let e=()=>{var e;t((null===(e=window.ethereum)||void 0===e?void 0:e.isMiniPay)===!0),a(!1)};e();let s=setTimeout(e,100);return()=>clearTimeout(s)}},[]),{isMiniPay:e,isChecking:s}}}}]);